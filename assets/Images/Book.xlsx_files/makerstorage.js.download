!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=25)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27);t.getAccessToken=n.getAccessToken,t.getMlapiAccessToken=n.getMlapiAccessToken,t.setUserAccessInfo=n.setUserAccessInfo,t.setAccessToken=n.setAccessToken,t.setMlapiAccessToken=n.setMlapiAccessToken,t.setAdminAccessToken=n.setAdminAccessToken,t.getAdminAccessToken=n.getAdminAccessToken;var o=r(28);t.setNodeFetch=o.setNodeFetch,t.usingNodeFetch=o.usingNodeFetch;var i=r(13);t.getDelay=i.getDelay,t.inDevMode=i.inDevMode,t.useLocalStorage=i.useLocalStorage;var s=r(29);t.getSessionId=s.getSessionId,t.setSessionId=s.setSessionId;var a=r(14);t.buildAdminUrl=a.buildAdminUrl,t.buildStorageUrl=a.buildStorageUrl,t.buildV1Url=a.buildV1Url,t.setStorageEnvironmentOverride=a.setStorageEnvironmentOverride;var c=r(30);t.clearFlightCache=c.clearFlightCache,t.getFlightValue=c.getFlightValue,t.setFlightValue=c.setFlightValue;var u=r(31);t.buildConsentUrl=u.buildConsentUrl,t.buildDefaultDriveIdUrl=u.buildDefaultDriveIdUrl,t.buildGetMyScriptsUrl=u.buildGetMyScriptsUrl,t.buildGetOrganizationUrl=u.buildGetOrganizationUrl,t.buildGetSharedScriptsUrl=u.buildGetSharedScriptsUrl,t.buildGetSharedScriptUrl=u.buildGetSharedScriptUrl,t.buildGraphScriptUrl=u.buildGraphScriptUrl,t.buildLogRunUrl=u.buildLogRunUrl,t.buildRecentScriptsUrl=u.buildRecentScriptsUrl,t.buildScriptCrudUrl=u.buildScriptCrudUrl,t.buildScriptSearchUrl=u.buildScriptSearchUrl,t.buildScriptShareUrl=u.buildScriptShareUrl,t.buildScriptVersioningUrl=u.buildScriptVersioningUrl,t.buildScriptVersionRestorationUrl=u.buildScriptVersionRestorationUrl,t.buildTenantPolicyUrl=u.buildTenantPolicyUrl,t.buildUpdateScriptContentsUrl=u.buildUpdateScriptContentsUrl,t.buildUpdateScriptNameUrl=u.buildUpdateScriptNameUrl,t.buildUserPermissionsUrl=u.buildUserPermissionsUrl},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16);t.setIntegrationFlag=n.setIntegrationFlag;var o=r(17);t.makeHttpRequest=o.makeHttpRequest;var i=r(39);t.MakerStorageError=i.MakerStorageError;var s=r(40);t.makeDeleteRequest=s.makeDeleteRequest,t.makeGetRequest=s.makeGetRequest,t.makePatchRequest=s.makePatchRequest,t.makePostRequest=s.makePostRequest,t.makePutRequest=s.makePutRequest;var a=r(18);t.setFlightHeader=a.setFlightHeader;var c=r(19);t.StorageServiceError=c.StorageServiceError},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CXPSStrings={Namespace:"http://schemas.microsoft.com/office/extensibility/maker/v1.0",ScriptIdNodeTag:"scriptId",ScriptIdsNodeId:"script-ids-node-id"},t.StorageResourceIdFirstParty="https://officescripting.microsoft.com",t.StorageResourceIdFirstPartyTest="https://officescripting-test.microsoft.com",t.SERVICE_URLS={prodNew:"https://api.officescripts.microsoftusercontent.com/api",int:"https://api.runtime.arbitraryrunner.com/api",test:"https://api.test.arbitraryrunner.com/api",local:"http://localhost:30002/api"},t.MLAPI_MAKER_SCOPE="Microsoft.Internal.OfficeScriptingConsentScopes",t.MLAPI_URL="https://substrate.office.com/profile/v1.0/me/allExtensions/Microsoft.Internal.OfficeScriptingConsentScopes",t.MAX_SCRIPT_NAME_LENGTH=80,t.MAX_SCRIPT_DESCRIPTION_LENGTH=500,t.SIMULATED_DELAY=50,t.NUM_MILLISECONDS_PER_SECOND=1e3,function(e){e[e.VersionUnsupported=-3]="VersionUnsupported",e[e.WorkbookCustomXMLMalformed=-2]="WorkbookCustomXMLMalformed",e[e.WorkbookCustomXMLNotFound=-1]="WorkbookCustomXMLNotFound",e[e.ServiceUnavailable=0]="ServiceUnavailable",e[e.UnexpectedException=1]="UnexpectedException",e[e.UnhandledException=2]="UnhandledException",e[e.AccessDenied=3]="AccessDenied",e[e.AsyncProcessingError=4]="AsyncProcessingError",e[e.ItemNotFound=5]="ItemNotFound",e[e.MaxItemCountExceeded=6]="MaxItemCountExceeded",e[e.NameAlreadyExists=7]="NameAlreadyExists",e[e.NotAllowed=8]="NotAllowed",e[e.PayloadTooLarge=9]="PayloadTooLarge",e[e.GraphItemContentsInvalid=10]="GraphItemContentsInvalid",e[e.InvalidFileName=11]="InvalidFileName",e[e.InvalidRequest=12]="InvalidRequest",e[e.UserCannotShare=13]="UserCannotShare",e[e.TokenExpired=14]="TokenExpired",e[e.Timeout=15]="Timeout",e[e.GraphCommunicationFailed=16]="GraphCommunicationFailed",e[e.PlatformDisabled=17]="PlatformDisabled",e[e.InvalidScriptReference=18]="InvalidScriptReference",e[e.InvalidMruItem=19]="InvalidMruItem",e[e.PropertyMissing=20]="PropertyMissing"}(t.StorageErrorCode||(t.StorageErrorCode={})),t.flightHeaderPrefix="x-ms-flight-",t.RestApiVersionFlightKey="RestApiVersion"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(32);t.getIsIEBrowser=n.getIsIEBrowser;var o=r(33);t.pause=o.pause;var i=r(34);t.shouldUseApiV1=i.shouldUseApiV1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(37);t.convertResponseFolderJson=n.convertResponseFolderJson,t.convertResponseJson=n.convertResponseJson,t.convertResponseJsonArray=n.convertResponseJsonArray,t.convertResponseScriptVersionJson=n.convertResponseScriptVersionJson,t.convertResponseScriptVersionJsonArray=n.convertResponseScriptVersionJsonArray;var o=r(15);t.parseVersion=o.parseVersion},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(59);t.addScriptToLocalStorage=n.addScriptToLocalStorage;var o=r(23);t.getScriptFromLocalStorage=o.getScriptFromLocalStorage;var i=r(61);t.getScriptsFromLocalStorage=i.getScriptsFromLocalStorage;var s=r(62);t.getSharedScriptFromLocalStorage=s.getSharedScriptFromLocalStorage;var a=r(63);t.removeScriptFromLocalStorage=a.removeScriptFromLocalStorage;var c=r(64);t.shareScriptToLocalStorage=c.shareScriptToLocalStorage;var u=r(65);t.unshareScriptFromLocalStorage=u.unshareScriptFromLocalStorage;var l=r(66);t.updateScriptOnLocalStorage=l.updateScriptOnLocalStorage},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(60),i=r(3);function s(e){var t={};return e.forEach((function(e,r){return t[r]=e})),t}t.getScriptsMap=function(){var e=JSON.parse(localStorage.getItem(n.LocalStorageKeys.recordedScriptsKey)||"{}");return i.getIsIEBrowser()&&o.loadObjectEntriesPolyfill(),new Map(Object.entries(e))},t.updateLocalStorage=function(e,t){window.localStorage.setItem(e,JSON.stringify(s(t)))},t.convertMapToObject=s,t.getSharedScriptsMap=function(){var e=JSON.parse(localStorage.getItem(n.LocalStorageKeys.sharedScriptsKey)||"{}");return i.getIsIEBrowser()&&o.loadObjectEntriesPolyfill(),new Map(Object.entries(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageKeys={recordedScriptsKey:"recorded-maker-scripts",lastOpenedScriptKey:"last-opened-script",sharedScriptsKey:"shared-maker-scripts"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(35);t.convertToHierarchy=n.convertToHierarchy;var o=r(36);t.createFolder=o.createFolder;var i=r(49);t.createScript=i.createScript;var s=r(56);t.getAllVersionsOfScript=s.getAllVersionsOfScript;var a=r(57);t.getDefaultDriveId=a.getDefaultDriveId;var c=r(58);t.getGraphScript=c.getGraphScript;var u=r(67);t.getRecentScripts=u.getRecentScripts;var l=r(11);t.getScript=l.getScript;var d=r(12);t.getScripts=d.getScripts;var f=r(68);t.getSharedScript=f.getSharedScript;var p=r(69);t.getSharedScripts=p.getSharedScripts;var h=r(70);t.getVersionOfScript=h.getVersionOfScript;var b=r(71);t.removeRecentScript=b.removeRecentScript;var v=r(24);t.removeScript=v.removeScript;var y=r(72);t.restoreVersionOfScript=y.restoreVersionOfScript;var m=r(73);t.saveScript=m.saveScript;var S=r(76);t.searchScripts=S.searchScripts;var g=r(77);t.updateScriptName=g.updateScriptName;var w=r(78);t.updateScriptContents=w.updateScriptContents;var I=r(9);t.isScriptDescriptionValid=I.isScriptDescriptionValid,t.isScriptNameValid=I.isScriptNameValid;var _=r(79);t.shareScript=_.shareScript;var k=r(80);t.unshareScript=k.unshareScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.isScriptNameValid=function(e){var t=new RegExp(/^(\s*)$/);if(!e.length||t.test(e))return{error:"Name is empty"};if(e.length>n.MAX_SCRIPT_NAME_LENGTH)return{error:"Name is too long"};var r=new RegExp(/(^((\.lock)|(CON)|(PRN)|(AUX)|(NUL)|(COM\d{1})|(LPT\d{1})|(desktop.ini))$)|(_vti_)|(^~\$)/),o=e.match(r);if(o)return{error:"Invalid name",invalidSubstring:o[0]};var i=new RegExp(/(["*:<>?\/\\|%&\.])/),s=e.match(i);if(s)return{error:"Name contains invalid character",invalidSubstring:s[0]};var a=new RegExp(/([\s]$)/);return e.match(a)?{error:"Name ends in whitespace"}:{error:"None"}},t.isScriptDescriptionValid=function(e){return e.length<=n.MAX_SCRIPT_DESCRIPTION_LENGTH}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.id_first="test-script-first",t.id_second="test-script-second",t.xmlEmpty='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"></scriptIds>',t.xmlOneScript='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId></scriptIds>',t.xmlTwoScripts='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId><scriptId id="'+t.id_second+'"></scriptId></scriptIds>',t.xmlMalformed='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId><scriptId></scriptId></scriptIds>',t.mockRequestId="Request-uuid",t.mockTenantId="Tenant-guid",t.mockUserId="0a088C17MOCKPUID",t.mockEnableStorageErrorHandling=!0,t.mockDisableStorageErrorHandling=!1,t.mockOrganizationDisplayName="Contoso",t.mockTimestamp="2019-08-23T20:58:49.598Z"},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(5),a=r(0),c=r(4),u=r(1),l=r(3);function d(e,t,r,s,l,d){return void 0===l&&(l=!0),o(this,void 0,void 0,(function(){var o,f,p;return i(this,(function(i){switch(i.label){case 0:return[4,u.makeGetRequest(e,a.getAccessToken(),n(n(n({"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()},r?{"x-ms-ShouldUpdateMru":r}:{}),s?{"x-ms-MruItemId":s}:{}),d?{"accept-language":d}:{}))];case 1:return[4,(o=i.sent()).json()];case 2:return f=i.sent(),p=o.headers.get("Version"),[2,c.convertResponseJson(f,p,l)]}}))}))}t.getScriptInternal=d,t.getScript=function(e,t,r){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return a.inDevMode()?[4,l.pause(a.getDelay())]:[3,2];case 1:return n.sent(),[2,s.getScriptFromLocalStorage(e.id)];case 2:return[2,d(a.buildScriptCrudUrl(e.id),t,r,e.mruItemId)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(5),a=r(0),c=r(4),u=r(1),l=r(3);function d(e,t,r,s){return void 0===r&&(r=!0),o(this,void 0,void 0,(function(){var o,l,d;return i(this,(function(i){switch(i.label){case 0:return[4,u.makeGetRequest(e,a.getAccessToken(),n({"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()},s?{"accept-language":s}:{}))];case 1:return[4,(o=i.sent()).json()];case 2:return l=i.sent(),d=o.headers.get("Version"),[2,c.convertResponseJsonArray(l,d,r)]}}))}))}t.getScriptsInternal=d,t.getScripts=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return a.inDevMode()?[4,l.pause(a.getDelay())]:[3,2];case 1:return t.sent(),[2,s.getScriptsFromLocalStorage()];case 2:return[2,d(a.buildGetMyScriptsUrl(),e)]}}))}))}},function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=function(e,t){if(!e)return n=null,void(o=0);n=e,o=t||0},t.inDevMode=function(){return!!n},t.getDelay=function(){return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(2);function i(){return o.SERVICE_URLS[n]||o.SERVICE_URLS.prodNew}t.setStorageEnvironmentOverride=function(e){n=e},t.getServiceUrl=i,t.buildV1Url=function(){return i().concat("/v1.0")},t.buildStorageUrl=function(){return i().concat("/storage")},t.buildAdminUrl=function(){return i().concat("/admin")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1);t.parseVersion=function(e){var t=e.split(".");if(2===t.length)return{major:parseInt(t[0],10),minor:parseInt(t[1],10)};throw new o.MakerStorageError("Invalid version",n.StorageErrorCode.VersionUnsupported)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!1;t.setIntegrationFlag=function(e){return n=e},t.getIntegrationFlag=function(){return n}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(38)),a=r(16),c=r(18),u=r(19),l=r(2),d=r(0);function f(e){return n(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:if(e.ok)return[3,5];if(t=void 0,r=void 0,401,401===e.status)throw new u.StorageServiceError("unauthorized",e.status,l.StorageErrorCode.AccessDenied);o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.json()];case 2:return n=o.sent(),t=n.message,r=n.storageErrorCode,[3,4];case 3:return o.sent(),t="Server returned non-json response",r=l.StorageErrorCode.UnexpectedException,[3,4];case 4:throw void 0===r&&(r=l.StorageErrorCode.UnexpectedException),new u.StorageServiceError(t,e.status,r);case 5:return[2,e]}}))}))}t.makeHttpRequest=function(e,t,r,i,u){return n(this,void 0,void 0,(function(){var n,l,p,h,b,v,y,m,S;return o(this,(function(o){switch(o.label){case 0:return n=r.customHeaders,l=r.requestBody,p={method:t},h={},n&&Object.keys(n).forEach((function(e){h[e]=n[e]})),a.getIntegrationFlag()&&(d.setFlightValue("SkipTenantPolicyCache","true"),c.setFlightHeader(h,"SkipTenantPolicyCache"),d.setFlightValue("EnableSharePointCalls","true"),c.setFlightHeader(h,"EnableSharePointCalls"),d.setFlightValue("EnableMruCalls","true"),c.setFlightHeader(h,"EnableMruCalls")),u&&(h.Authorization="Bearer "+u),null!=l&&(h["Content-Type"]="application/json",p.body=JSON.stringify(l)),h["Cache-Control"]="no-store",p.headers=h,b=d.usingNodeFetch()?s.default:fetch,a.getIntegrationFlag()&&(console.log(""),console.log("http request "+t+" "+e),h["x-ms-client-request-id"]&&console.log("request id "+h["x-ms-client-request-id"])),[4,b(e,p)];case 1:return v=o.sent(),a.getIntegrationFlag()?(m=(y=console).log,S="http response ",[4,v.clone().text()]):[3,3];case 2:m.apply(y,[S+o.sent()]),console.log(""),o.label=3;case 3:return i?[2,f(v)]:[2,v]}}))}))},t.handleResponse=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(0);t.setFlightHeader=function(e,t){e[n.flightHeaderPrefix+t]=o.getFlightValue(t)}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(r,n,o){var i=e.call(this,r)||this;return i.status=n,i.errorCode=o,Object.setPrototypeOf(i,t.prototype),i}return o(t,e),t}(Error);t.StorageServiceError=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(41);t.getUserPermissions=n.getUserPermissions,t.getUserId=n.getUserId,t.getTenantId=n.getTenantId,t.clearUserPermissionCache=n.clearUserPermissionCache},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.mockAccessToken="eyBearerAuthmockAccessTokenfromGraphtobeSenttoRest",t.mockMlapiAccessToken="eyBearerAuthmockMLAPITokenfromtobeSenttoRest",t.newMockAccessToken="eyBearerAuthmockAccessTokenfromGraphtobeSenttoRestNew",t.newMockMlapiAccessToken="eyBearerAuthmockMLAPITokenfromtobeSenttoRestNew",t.mockDelay=100,t.mockDevMode=!0,t.mockSessionId="1234567890-mock-sess-ionId-bbbbbbbbbbb987654321",t.mockStorageUrl="https://maker-storage.com",t.cleanUpMockProviders=function(){n.setUserAccessInfo({currentUserToken:null,currentUserMlapiToken:null}),n.setAdminAccessToken(null),n.useLocalStorage(!1)}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(2),i=r(1);t.getScriptFromLocalStorage=function(e){var t=n.getScriptsMap().get(e);if(!t)throw new i.MakerStorageError("Script does not exist!",o.StorageErrorCode.ItemNotFound);return t}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(5),a=r(0),c=r(1),u=r(3);function l(e,t,r,s){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,c.makeDeleteRequest(e,a.getAccessToken(),n(n({"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()},r?{"x-ms-ShouldUpdateMru":r}:{}),s?{"x-ms-MruItemId":s}:{}))]}))}))}t.removeScriptInternal=l,t.removeScript=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return a.inDevMode()?[4,u.pause(a.getDelay())]:[3,2];case 1:return r.sent(),[2,s.removeScriptFromLocalStorage(e.id)];case 2:return[2,l(a.buildScriptCrudUrl(e.id),t,!0,e.mruItemId)]}}))}))}},function(e,t,r){"use strict";!function(){if("fetch"in window||(console.log("Fetch API not found, try including the polyfill"),r(26)),"fetch"in window){var e=r(0).setUserAccessInfo,t=r(0).setSessionId,n=r(0).setFlightValue,o=r(8).getRecentScripts,i=r(8).getScripts,s=r(8).getSharedScript,a=r(8).getSharedScripts,c=r(20).getUserPermissions,u=r(0).setStorageEnvironmentOverride,l=r(0).useLocalStorage,d=r(8).saveScript,f=r(1).StorageServiceError;window.makerstorage={setUserAccessInfo:e,setSessionId:t,setFlightValue:n,getRecentScripts:o,getScripts:i,getSharedScript:s,getSharedScripts:a,getUserPermissions:c,setStorageEnvironmentOverride:u,useLocalStorage:l,saveScript:d,StorageServiceError:f}}}()},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return p})),r.d(t,"Request",(function(){return g})),r.d(t,"Response",(function(){return I})),r.d(t,"DOMException",(function(){return k})),r.d(t,"fetch",(function(){return M}));var n="URLSearchParams"in self,o="Symbol"in self&&"iterator"in Symbol,i="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in self,a="ArrayBuffer"in self;if(a)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function b(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function v(e){var t=new FileReader,r=b(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var e,t,r,n=h(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=b(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=l(e),t=d(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},p.prototype.delete=function(e){delete this.map[l(e)]},p.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},p.prototype.set=function(e,t){this.map[l(e)]=d(t)},p.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),f(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),f(e)},o&&(p.prototype[Symbol.iterator]=p.prototype.entries);var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(e,t){var r,n,o=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),S.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function I(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},m.call(g.prototype),m.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];I.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})};var k=self.DOMException;try{new k}catch(e){(k=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),k.prototype.constructor=k}function M(e,t){return new Promise((function(r,n){var o=new g(e,t);if(o.signal&&o.signal.aborted)return n(new k("Aborted","AbortError"));var s=new XMLHttpRequest;function a(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;r(new I(o,n))},s.onerror=function(){n(new TypeError("Network request failed"))},s.ontimeout=function(){n(new TypeError("Network request failed"))},s.onabort=function(){n(new k("Aborted","AbortError"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),o.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",a),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",a)}),s.send(void 0===o._bodyInit?null:o._bodyInit)}))}M.polyfill=!0,self.fetch||(self.fetch=M,self.Headers=p,self.Request=g,self.Response=I)},function(e,t,r){"use strict";var n,o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.setUserAccessInfo=function(e){n=e.currentUserToken,i=e.currentUserMlapiToken},t.setAccessToken=function(e){n=e},t.setMlapiAccessToken=function(e){i=e},t.setAdminAccessToken=function(e){o=e},t.getMlapiAccessToken=function(){if(!i)throw new Error("Access token not set.");return i},t.getAdminAccessToken=function(){if(!o)throw new Error("Admin access token not set.");return o},t.getAccessToken=function(){if(!n)throw new Error("Access token not set.");return n}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.setNodeFetch=function(e){n=!!e||null},t.usingNodeFetch=function(){return!!n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(13);t.setSessionId=function(e){n=e},t.getSessionId=function(){if(o.inDevMode())return null;if(!n)throw new Error("Session id not set.");return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.setFlightValue=function(e,t){n[e]=t},t.getFlightValue=function(e){var t;return null!=(t=n[e])?t:""},t.clearFlightCache=function(){n={}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(3);t.buildUserPermissionsUrl=function(){return o.shouldUseApiV1()?n.buildV1Url()+"/me/policy":n.buildAdminUrl()+"/me/policy"},t.buildGetOrganizationUrl=function(){return o.shouldUseApiV1()?n.buildV1Url()+"/me/organization":n.buildAdminUrl()+"/me/organization"},t.buildDefaultDriveIdUrl=function(){return o.shouldUseApiV1()?n.buildV1Url()+"/me/defaultDriveId":n.buildStorageUrl()+"/defaultdriveid"},t.buildRecentScriptsUrl=function(e){return e=e?"/"+e:"",o.shouldUseApiV1()?n.buildV1Url()+"/me/recentScripts"+e:n.getServiceUrl()+"/recent"+e},t.buildGetMyScriptsUrl=function(){return o.shouldUseApiV1()?n.buildV1Url()+"/me/scripts":n.buildStorageUrl()},t.buildScriptCrudUrl=function(e){return e=e?"/"+e:"",o.shouldUseApiV1()?n.buildV1Url()+"/scripts"+e:""+n.buildStorageUrl()+e},t.buildUpdateScriptContentsUrl=function(e){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/contents":n.buildStorageUrl()+"/"+e+"/contents"},t.buildUpdateScriptNameUrl=function(e){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/name":n.buildStorageUrl()+"/"+e+"/name"},t.buildScriptSearchUrl=function(e){return o.shouldUseApiV1()?n.buildV1Url()+"/me/scripts?query="+encodeURIComponent(e.queryString):n.buildStorageUrl()+"/search"},t.buildScriptVersioningUrl=function(e,t){return t=t?"/"+t:"",o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/versions"+t:n.buildStorageUrl()+"/"+e+"/versions"+t},t.buildScriptVersionRestorationUrl=function(e,t){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/versions/"+t+"/restore":n.buildStorageUrl()+"/"+e+"/versions/"+t+"/restore"},t.buildConsentUrl=function(e,t){return t=t?"/"+t:"",o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/consent"+t:n.getServiceUrl()+"/consent/"+e+t},t.buildLogRunUrl=function(e){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/logRun":n.buildStorageUrl()+"/logRun"},t.buildGetSharedScriptUrl=function(e){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e:n.buildStorageUrl()+"/shared/"+e},t.buildGetSharedScriptsUrl=function(){return o.shouldUseApiV1()?n.buildV1Url()+"/me/scriptsSharedWithMe":n.buildStorageUrl()+"/shared"},t.buildScriptShareUrl=function(e){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/"+e+"/shareId":n.buildStorageUrl()+"/"+e+"/share"},t.buildGraphScriptUrl=function(e,t){return o.shouldUseApiV1()?n.buildV1Url()+"/scripts/graph/"+e+"/"+t:n.buildStorageUrl()+"/getGraphScript/"+e+"/"+t},t.buildTenantPolicyUrl=function(){return o.shouldUseApiV1()?n.buildV1Url()+"/policy":n.buildAdminUrl()+"/policy/tenant"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIsIEBrowser=function(){return/MSIE|Trident/.test(window.navigator.userAgent)}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.pause=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(0);t.shouldUseApiV1=function(){return"1"===o.getFlightValue(n.RestApiVersionFlightKey)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){for(var r=0,o=e.folders;r<o.length;r++){var i=o[r];if(i.id===t.id)return i}var s=n(n({},t),{scripts:new Set,folders:[]});return e.folders.push(s),s}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToHierarchy=function(e){for(var t,r={id:"",name:"",parentId:"",scripts:new Set,folders:[]},n=0,i=e;n<i.length;n++){var s=i[n];if(null===(t=s.path)||void 0===t?void 0:t.length){for(var a=s.path,c=0,u=o(r,a[0]);c<a.length;u=++c<a.length?o(u,a[c]):u);u.scripts.add(s.id)}else r.scripts.add(s.id)}return r}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(4),a=r(1);function c(e,t,r){return n(this,void 0,void 0,(function(){var n,c,u;return o(this,(function(o){switch(o.label){case 0:return[4,a.makePostRequest(e,t,i.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":i.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return c=o.sent(),u=n.headers.get("Version"),[2,s.convertResponseFolderJson(c,u)]}}))}))}t.createFolderInternal=c,t.createFolder=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,c(i.buildStorageUrl()+"/folder",e,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(15),s=r(20),a=r(1),c=r(47),u=r(48),l=r(2);t.convertResponseJson=function(e,t,r){return void 0===r&&(r=!0),n(this,void 0,void 0,(function(){var n,d,f;return o(this,(function(o){switch(o.label){case 0:if(null==t)throw new a.MakerStorageError("Version should not be null",l.StorageErrorCode.VersionUnsupported);return n=i.parseVersion(t),r?(f=null,[3,3]):[3,1];case 1:return[4,s.getUserId()];case 2:f=o.sent(),o.label=3;case 3:switch(d=f,n.major){case 3:return[2,u.convertResponseToScriptV3(e,n.minor,d)];case 2:return[2,c.convertResponseToScriptV2(e,n.minor,d)];default:throw new a.MakerStorageError("Major version number not supported",l.StorageErrorCode.VersionUnsupported)}return[2]}}))}))},t.convertResponseJsonArray=function(e,t,r){return void 0===r&&(r=!0),n(this,void 0,void 0,(function(){var n,d,f;return o(this,(function(o){switch(o.label){case 0:if(null==t)throw new a.MakerStorageError("Version should not be null",l.StorageErrorCode.VersionUnsupported);return n=i.parseVersion(t),r?(f=null,[3,3]):[3,1];case 1:return[4,s.getUserId()];case 2:f=o.sent(),o.label=3;case 3:switch(d=f,n.major){case 3:return[2,u.convertResponseToScriptCoresV3(e,n.minor,d)];case 2:return[2,c.convertResponseToScriptCoresV2(e,n.minor,d)];default:throw new a.MakerStorageError("Major version number not supported",l.StorageErrorCode.VersionUnsupported)}return[2]}}))}))},t.convertResponseFolderJson=function(e,t){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){if(null==t)throw new a.MakerStorageError("Version should not be null",l.StorageErrorCode.VersionUnsupported);switch((r=i.parseVersion(t)).major){case 3:return[2,u.convertResponseToFolderV3(e,r.minor)];case 2:return[2,c.convertResponseToFolderV2(e,r.minor)];default:throw new a.MakerStorageError("Major version number not supported",l.StorageErrorCode.VersionUnsupported)}return[2]}))}))},t.convertResponseScriptVersionJson=function(e,t){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){if(null==t)throw new Error("Version should not be null");switch((r=i.parseVersion(t)).major){case 3:return[2,u.convertResponseToScriptVersionV3(e,r.minor)];default:throw new Error("Major version number not supported")}return[2]}))}))},t.convertResponseScriptVersionJsonArray=function(e,t){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){if(null==t)throw new Error("Version should not be null");switch((r=i.parseVersion(t)).major){case 3:return[2,u.convertResponseToScriptVersionArrayV3(e,r.minor)];default:throw new Error("Major version number not supported")}return[2]}))}))}},function(e,t,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,t.default=n.fetch.bind(n),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(r,n){var o=e.call(this,r)||this;return o.errorCode=n,Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t}(Error);t.MakerStorageError=i},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(17);t.makeGetRequest=function(e,t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={customHeaders:r},[2,i.makeHttpRequest(e,"GET",n,!0,t)]}))}))},t.makePostRequest=function(e,t,r,s){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={requestBody:t,customHeaders:s},[2,i.makeHttpRequest(e,"POST",n,!0,r)]}))}))},t.makePutRequest=function(e,t,r,s){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={requestBody:t,customHeaders:s},[2,i.makeHttpRequest(e,"PUT",n,!0,r)]}))}))},t.makePatchRequest=function(e,t,r,s){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={requestBody:t,customHeaders:s},[2,i.makeHttpRequest(e,"PATCH",n,!0,r)]}))}))},t.makeDeleteRequest=function(e,t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={customHeaders:r},[2,i.makeHttpRequest(e,"DELETE",n,!0,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(42),s=r(43),a=r(0),c=r(1),u=r(3);function l(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,c.makeGetRequest(e,a.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()})];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))}function d(e){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return a.inDevMode()?[4,u.pause(a.getDelay())]:[3,2];case 1:return n.sent(),t.userPermissions=Promise.resolve({UserId:s.mockUserId,TenantId:s.mockTenantId,OfficeScriptingEnabled:!0,SharingEnabled:!0}),[2,t.userPermissions];case 2:return r=i.convertToUserPermissions,[4,l(a.buildUserPermissionsUrl(),e)];case 3:return[2,r.apply(void 0,[n.sent()])]}}))}))}t.getUserPermissionsInternal=l,t.getUserPermissions=d,t.getUserId=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.userPermissions?[3,2]:[4,d("")];case 1:return[2,e.sent().UserId];case 2:return[4,t.userPermissions];case 3:return[2,e.sent().UserId]}}))}))},t.getTenantId=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.userPermissions?[3,2]:[4,d("")];case 1:return[2,e.sent().TenantId];case 2:return[4,t.userPermissions];case 3:return[2,e.sent().TenantId]}}))}))},t.clearUserPermissionCache=function(){t.userPermissions=null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertToUserPermissions=function(e){return void 0!==e.OfficeScriptingEnabled?e:{UserId:(e=e).userId,TenantId:e.tenantId,OfficeScriptingEnabled:e.officeScriptingEnabled,SharingEnabled:e.sharingEnabled}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(44);t.getMockContext=n.getMockContext;var o=r(45);t.getMockCustomHeaders=o.getMockCustomHeaders;var i=r(46);t.generateMockConsentRecord=i.generateMockConsentRecord,t.getMockScriptFromServiceV2=i.getMockScriptFromServiceV2,t.getMockScriptFromServiceV2_1=i.getMockScriptFromServiceV2_1,t.getMockScriptFromServiceV2_1Future=i.getMockScriptFromServiceV2_1Future,t.getMockScriptFromServiceV2_2=i.getMockScriptFromServiceV2_2,t.getMockScriptFromServiceV2_3=i.getMockScriptFromServiceV2_3,t.getMockScriptFromServiceV2_4_missingFolderId=i.getMockScriptFromServiceV2_4_missingFolderId,t.getMockScriptFromServiceV2_4_missingPath=i.getMockScriptFromServiceV2_4_missingPath,t.getMockScriptFromServiceV2_4=i.getMockScriptFromServiceV2_4,t.getMockScriptFromServiceV2_5=i.getMockScriptFromServiceV2_5,t.getMockScriptFromServiceV3=i.getMockScriptFromServiceV3,t.getMockScriptFromServiceV3_1=i.getMockScriptFromServiceV3_1,t.getMockScriptFromServiceV3_1_BadFolders=i.getMockScriptFromServiceV3_1_BadFolders,t.getMockScriptFromServiceV3_1_BadDriveId=i.getMockScriptFromServiceV3_1_BadDriveId,t.getMockScriptFromServiceV3_2=i.getMockScriptFromServiceV3_2,t.getMockScriptFromServiceV3_2_NoShareId=i.getMockScriptFromServiceV3_2_NoShareId,t.getMockScriptFolderFromServiceV2_4=i.getMockScriptFolderFromServiceV2_4,t.getMockScriptFolderFromServiceV3=i.getMockScriptFolderFromServiceV3,t.getMockScriptFolderFromServiceV3_1=i.getMockScriptFolderFromServiceV3_1,t.getMockScriptVersionFromServiceV3_3=i.getMockScriptVersionFromServiceV3_3;var s=r(10);t.id_first=s.id_first,t.id_second=s.id_second,t.xmlEmpty=s.xmlEmpty,t.xmlOneScript=s.xmlOneScript,t.xmlTwoScripts=s.xmlTwoScripts,t.xmlMalformed=s.xmlMalformed,t.mockRequestId=s.mockRequestId,t.mockTenantId=s.mockTenantId,t.mockUserId=s.mockUserId,t.mockDisableStorageErrorHandling=s.mockDisableStorageErrorHandling,t.mockEnableStorageErrorHandling=s.mockEnableStorageErrorHandling,t.mockOrganizationDisplayName=s.mockOrganizationDisplayName,t.mockTimestamp=s.mockTimestamp;var a=r(21);t.cleanUpMockProviders=a.cleanUpMockProviders,t.mockAccessToken=a.mockAccessToken,t.mockMlapiAccessToken=a.mockMlapiAccessToken,t.newMockAccessToken=a.newMockAccessToken,t.newMockMlapiAccessToken=a.newMockMlapiAccessToken,t.mockDelay=a.mockDelay,t.mockDevMode=a.mockDevMode,t.mockSessionId=a.mockSessionId,t.mockStorageUrl=a.mockStorageUrl},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMockContext=function(e){return{workbook:{customXmlParts:{add:jest.fn(),getByNamespace:function(){return{getCount:function(){return{value:e}},getOnlyItem:jest.fn((function(){return{getXml:jest.fn((function(){return{value:""}})),setXml:jest.fn()}}))}}}},sync:jest.fn()}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(21),i=r(10);t.getMockCustomHeaders=function(e){var t,r,s;return n(n(n({"x-ms-client-request-id":i.mockRequestId,"X-UserSessionId":o.mockSessionId},(null===(t=e)||void 0===t?void 0:t.shouldUpdateMru)?{"x-ms-ShouldUpdateMru":e.shouldUpdateMru}:{}),(null===(r=e)||void 0===r?void 0:r.mruItemId)?{"x-ms-MruItemId":e.mruItemId}:{}),(null===(s=e)||void 0===s?void 0:s.culture)?{"accept-language":e.culture}:{})}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);function i(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}}t.getMockScriptFromServiceV2=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_1=i,t.getMockScriptFromServiceV2_1Future=function(){return n(n({},{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}),{futureProperty:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"})},t.getMockScriptFromServiceV2_2=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_3=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_4=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",path:[{id:"0123",name:"Folder 1",parentId:"0000"},{id:"12345",name:"Folder 2",parentId:"0123"}]}},t.getMockScriptFromServiceV2_4_missingFolderId=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",path:[{id:"0123",name:"Folder 1",parentId:"0000"},{id:"12345",name:"Folder 2",parentId:"0123"}]}},t.getMockScriptFromServiceV2_4_missingPath=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345"}},t.getMockScriptFromServiceV2_5=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",folderUrl:"some.url/",path:[{id:"0123",name:"Folder 1",parentId:"0000"},{id:"12345",name:"Folder 2",parentId:"0123"}]}},t.getMockScriptFromServiceV3=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",fileUrl:"some.url/file.osts",path:[{id:"0123",name:"Folder 1",parentId:"0000"},{id:"12345",name:"Folder 2",parentId:"0123"}]}},t.getMockScriptFromServiceV3_1=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",fileUrl:"some.url/file.osts",path:[{id:"0123",name:"Folder 1",parentId:"0000",driveId:"b!driveid"},{id:"12345",name:"Folder 2",parentId:"0123",driveId:"b!driveid"}],driveId:"b!driveId"}},t.getMockScriptFromServiceV3_1_BadDriveId=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",fileUrl:"some.url/file.osts",path:[{id:"0123",name:"Folder 1",parentId:"0000",driveId:"b!driveid"},{id:"12345",name:"Folder 2",parentId:"0123",driveId:"b!driveid"}]}},t.getMockScriptFromServiceV3_1_BadFolders=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",fileUrl:"some.url/file.osts",path:[{id:"0123",name:"Folder 1",parentId:"0000"},{id:"12345",name:"Folder 2",parentId:"0123"}],driveId:"b!driveId"}},t.getMockScriptFromServiceV3_2=function(){return{id:"testId",mruItemId:"mruItemId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",fileUrl:"some.url/file.osts",path:[{id:"0123",name:"Folder 1",parentId:"0000",driveId:"b!driveid"},{id:"12345",name:"Folder 2",parentId:"0123",driveId:"b!driveid"}],driveId:"b!driveId"}},t.getMockScriptFromServiceV3_2_NoShareId=function(){return{id:"testId",mruItemId:"mruItemId",shareId:void 0,dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",fileUrl:"some.url/file.osts",path:[{id:"0123",name:"Folder 1",parentId:"0000",driveId:"b!driveid"},{id:"12345",name:"Folder 2",parentId:"0123",driveId:"b!driveid"}],driveId:"b!driveId"}},t.getMockScriptFolderFromServiceV2_4=function(){return{id:"12345",name:"Folder 2",parentId:"0123"}},t.getMockScriptFolderFromServiceV3=function(){return{id:"12345",name:"Folder 2",parentId:"0123"}},t.getMockScriptFolderFromServiceV3_1=function(){return{id:"12345",name:"Folder 2",parentId:"0123",driveId:"b!driveid"}},t.generateMockConsentRecord=function(e){return void 0===e&&(e=0),{scriptId:"scriptId"+e,documentId:"documentId"+e,scopes:["ReadWriteCurrentDocument"],createdTimestamp:o.mockTimestamp,userIds:["id1","id2"]}},t.getMockScriptVersionFromServiceV3_3=function(){return{versionId:"1.0",lastModifiedByUser:"abcd",lastModifiedByUserName:"test user",lastModifiedByUserEmail:"testuser@example.com",dateLastModified:3,scriptBody:"script body",description:"description",parameterInfo:"parameters",apiInfo:"batch"}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),i=r(1);function s(e,t){if(t<4)throw new i.MakerStorageError("Minor version number not supported",o.StorageErrorCode.VersionUnsupported);return{id:e.id,name:e.name,parentId:e.parentId}}function a(e,t){return e.map((function(e){return s(e,t)}))}function c(e,t,r){var n={id:e.id,shareId:e.shareId,name:e.name,parameterInfo:e.parameterInfo,dateFirstPublished:e.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:e.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:e.owner,lastModifiedBy:e.lastModifiedBy,isCreator:!r||e.owner===r};if(t>=1){if(null==e.ownerDisplayName)throw new i.MakerStorageError("Missing expected property in response: ownerDisplayName",o.StorageErrorCode.PropertyMissing);n.creatorDisplayName=e.ownerDisplayName}if(t>=4){if(null==e.path)throw new i.MakerStorageError("Missing expected property in response: path",o.StorageErrorCode.PropertyMissing);if(null==e.folderId)throw new i.MakerStorageError("Missing expected property in response: folderId",o.StorageErrorCode.PropertyMissing);n.path=a(e.path,t),n.folderId=e.folderId}if(t>=5){if(null==e.folderUrl)throw new i.MakerStorageError("Missing expected property in response: folderUrl",o.StorageErrorCode.PropertyMissing);n.folderUrl=e.folderUrl}return n}t.convertResponseToFolderV2=s,t.convertResponseToFoldersV2=a,t.convertResponseToScriptCoresV2=function(e,t,r){return e.map((function(e){return c(e,t,r)}))},t.convertResponseToScriptV2=function(e,t,r){var s=n(n({},c(e,t,r)),{body:e.body,description:e.description});if(t>=2){if(null==e.apiInfo)throw new i.MakerStorageError("Missing expected property in response: apiInfo",o.StorageErrorCode.PropertyMissing);s.apiInfo=e.apiInfo}if(t>=3){if(null==e.ownerEmail)throw new i.MakerStorageError("Missing expected property in response: ownerEmail",o.StorageErrorCode.PropertyMissing);s.creatorEmail=e.ownerEmail}return s}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),i=r(1);function s(e,t){var r={id:e.id,name:e.name,parentId:e.parentId};if(t>=1){if(null==e.driveId)throw new i.MakerStorageError("Missing expected property in response: folder driveId",o.StorageErrorCode.PropertyMissing);r.driveId=e.driveId}return r}function a(e,t){return e.map((function(e){return s(e,t)}))}function c(e,t,r){var n={id:e.id,shareId:e.shareId,name:e.name,dateFirstPublished:t>=2&&-1===e.dateFirstPublished?Date.now():e.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:e.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:e.owner,creatorEmail:e.ownerEmail,lastModifiedBy:e.lastModifiedBy,isCreator:!r||e.owner===r,creatorDisplayName:e.ownerDisplayName,path:a(e.path,t),folderId:e.folderId,fileUrl:e.fileUrl};if(t>=1){if(null==e.driveId)throw new i.MakerStorageError("Missing expected property in response: script driveId",o.StorageErrorCode.PropertyMissing);n.driveId=e.driveId}if(t>=2){if(null==e.mruItemId)throw new i.MakerStorageError("Missing expected property in response: mruItemId",o.StorageErrorCode.PropertyMissing);n.mruItemId=e.mruItemId}return n}function u(e,t){return{versionId:e.versionId,lastModifiedByUser:e.lastModifiedByUser,lastModifiedByUserName:e.lastModifiedByUserName,lastModifiedByUserEmail:e.lastModifiedByUserEmail,dateLastModified:e.dateLastModified*o.NUM_MILLISECONDS_PER_SECOND,body:e.body,description:e.description,parameterInfo:e.parameterInfo,apiInfo:e.apiInfo}}t.convertResponseToFolderV3=s,t.convertResponseToFoldersV3=a,t.convertResponseToScriptCoresV3=function(e,t,r){return e.map((function(e){return c(e,t,r)}))},t.convertResponseToScriptV3=function(e,t,r){return n(n({},c(e,t,r)),{body:e.body,description:e.description,apiInfo:e.apiInfo,parameterInfo:e.parameterInfo})},t.convertResponseToScriptVersionV3=u,t.convertResponseToScriptVersionArrayV3=function(e,t){return e.map((function(e){return u(e)}))}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(50));t.createScript=function(){return{id:o.default(),name:"New Script"}}},function(e,t,r){"use strict";const n=r(51),o=r(53),i=function(){return n()};i.regex={v4:/^([a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12})|(0{8}-0{4}-0{4}-0{4}-0{12})$/,v5:/^([a-f0-9]{8}-[a-f0-9]{4}-5[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12})|(0{8}-0{4}-0{4}-0{4}-0{12})$/},i.is=function(e){return!!e&&(i.regex.v4.test(e)||i.regex.v5.test(e))},i.empty=function(){return"00000000-0000-0000-0000-000000000000"},i.fromString=function(e){if(!e)throw new Error("Text is missing.");return o(e,"bb5d0ffa-9a4c-4d7c-8fc2-0a7d2220ba45")},e.exports=i},function(e,t,r){var n=r(52),o=r(22);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t,r){var n=r(54),o=r(55);e.exports=n("v5",80,o)},function(e,t,r){var n=r(22);e.exports=function(e,t,r){var o=function(e,o,i,s){var a=i&&s||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)),"string"==typeof o&&(o=function(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,(function(e){t.push(parseInt(e,16))})),t}(o)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(o)||16!==o.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=r(o.concat(e));if(c[6]=15&c[6]|t,c[8]=63&c[8]|128,i)for(var u=0;u<16;++u)i[a+u]=c[u];return i||n(c)};try{o.name=e}catch(e){}return o.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",o.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",o}},function(e,t,r){"use strict";function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function o(e,t){return e<<t|e>>>32-t}e.exports=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var i=unescape(encodeURIComponent(e));e=new Array(i.length);for(var s=0;s<i.length;s++)e[s]=i.charCodeAt(s)}e.push(128);var a=e.length/4+2,c=Math.ceil(a/16),u=new Array(c);for(s=0;s<c;s++){u[s]=new Array(16);for(var l=0;l<16;l++)u[s][l]=e[64*s+4*l]<<24|e[64*s+4*l+1]<<16|e[64*s+4*l+2]<<8|e[64*s+4*l+3]}for(u[c-1][14]=8*(e.length-1)/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=8*(e.length-1)&4294967295,s=0;s<c;s++){for(var d=new Array(80),f=0;f<16;f++)d[f]=u[s][f];for(f=16;f<80;f++)d[f]=o(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);var p=r[0],h=r[1],b=r[2],v=r[3],y=r[4];for(f=0;f<80;f++){var m=Math.floor(f/20),S=o(p,5)+n(m,h,b,v)+y+t[m]+d[f]>>>0;y=v,v=b,b=o(h,30)>>>0,h=p,p=S}r[0]=r[0]+p>>>0,r[1]=r[1]+h>>>0,r[2]=r[2]+b>>>0,r[3]=r[3]+v>>>0,r[4]=r[4]+y>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(4),a=r(1);function c(e,t){return n(this,void 0,void 0,(function(){var r,n,c;return o(this,(function(o){switch(o.label){case 0:return[4,a.makeGetRequest(e,i.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":i.getSessionId()})];case 1:return[4,(r=o.sent()).json()];case 2:return n=o.sent(),c=r.headers.get("Version"),[2,s.convertResponseScriptVersionJsonArray(n,c)]}}))}))}t.getAllVersionsOfScriptInternal=c,t.getAllVersionsOfScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,c(i.buildScriptVersioningUrl(e.shareId?e.shareId:e.id),t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(1);t.getDefaultDriveId=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,s.makeGetRequest(i.buildDefaultDriveIdUrl(),i.getAccessToken(),{"x-ms-client-request-id":e,"X-UserSessionId":i.getSessionId()})];case 1:return[4,t.sent().text()];case 2:return[2,t.sent()]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(11),s=r(0);t.getGraphScript=function(e,t,r,a,c){return n(this,void 0,void 0,(function(){return o(this,(function(n){return[2,i.getScriptInternal(s.buildGraphScriptUrl(e,t),a,c,void 0,!0,r)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(6);t.addScriptToLocalStorage=function(e){var t=i.getScriptsMap(),r=Date.now(),s=n(n({},e),{dateFirstPublished:r,dateLastPublished:r});return t.set(e.id,s),i.updateLocalStorage(o.LocalStorageKeys.recordedScriptsKey,t),s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadObjectEntriesPolyfill=function(){Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=Object.keys(e).map((function(t){return e[t]})),n=t.length,o=new Array(n);n--;)o[n]=[t[n],r[n]];return o})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6);t.getScriptsFromLocalStorage=function(){var e=[];return n.getScriptsMap().forEach((function(t){return e.push({id:t.id,name:t.name,dateFirstPublished:t.dateFirstPublished,dateLastPublished:t.dateLastPublished,creatorId:t.creatorId})})),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(2),i=r(1);t.getSharedScriptFromLocalStorage=function(e){var t=n.getSharedScriptsMap(),r=null;if(t.forEach((function(t){t.shareId===e&&(r=t)})),r)return r;throw new i.MakerStorageError("Shared script does not exist!",o.StorageErrorCode.ItemNotFound)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(6);t.removeScriptFromLocalStorage=function(e){var t=o.getScriptsMap();t.has(e)&&t.delete(e)&&o.updateLocalStorage(n.LocalStorageKeys.recordedScriptsKey,t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(23),s=r(6);function a(e){return"shareId-"+e}t.shareScriptToLocalStorage=function(e){var t=s.getSharedScriptsMap(),r=t.get(e);if(r)return r.shareId||"";var c=a(e),u=i.getScriptFromLocalStorage(e),l=n(n({},u),{shareId:c});return t.set(e,l),s.updateLocalStorage(o.LocalStorageKeys.sharedScriptsKey,t),c},t.generateTestShareId=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(6);t.unshareScriptFromLocalStorage=function(e){var t=o.getSharedScriptsMap();t.has(e)&&t.delete(e)&&o.updateLocalStorage(n.LocalStorageKeys.sharedScriptsKey,t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(6),s=r(2),a=r(1);t.updateScriptOnLocalStorage=function(e,t){var r=i.getScriptsMap();if(!r.has(e)||!r.get(e))throw new a.MakerStorageError("Script does not exist!",s.StorageErrorCode.ItemNotFound);var c=r.get(e),u=n(n(n({},c),t),{dateLastPublished:Date.now()});return r.set(e,u),i.updateLocalStorage(o.LocalStorageKeys.recordedScriptsKey,r),u}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),s=r(5),a=r(0),c=r(3);t.getRecentScripts=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return a.inDevMode()?[4,c.pause(a.getDelay())]:[3,2];case 1:return r.sent(),[2,s.getScriptsFromLocalStorage()];case 2:return[2,i.getScriptsInternal(a.buildRecentScriptsUrl(),t,!0,e)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(11),s=r(5),a=r(0),c=r(3);t.getSharedScript=function(e,t,r,u){return n(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return a.inDevMode()?[4,c.pause(a.getDelay())]:[3,2];case 1:return n.sent(),[2,s.getSharedScriptFromLocalStorage(e)];case 2:return[2,i.getScriptInternal(a.buildGetSharedScriptUrl(e),r,u,void 0,!1,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(12);t.getSharedScripts=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,s.getScriptsInternal(i.buildGetSharedScriptsUrl(),e,!1)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(4),a=r(1);function c(e,t){return n(this,void 0,void 0,(function(){var r,n,c;return o(this,(function(o){switch(o.label){case 0:return[4,a.makeGetRequest(e,i.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":i.getSessionId()})];case 1:return[4,(r=o.sent()).json()];case 2:return n=o.sent(),c=r.headers.get("Version"),[2,s.convertResponseScriptVersionJson(n,c)]}}))}))}t.getVersionOfScriptInternal=c,t.getVersionOfScript=function(e,t,r){return n(this,void 0,void 0,(function(){return o(this,(function(n){return[2,c(i.buildScriptVersioningUrl(e.id,t),r)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(24),s=r(0);t.removeRecentScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.removeScriptInternal(s.buildRecentScriptsUrl(e),t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),a=r(4),c=r(1);function u(e,t,r,u){return o(this,void 0,void 0,(function(){var o,l,d;return i(this,(function(i){switch(i.label){case 0:return[4,c.makePostRequest(e,null,s.getAccessToken(),n(n({"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()},r?{"x-ms-ShouldUpdateMru":r}:{}),u?{"x-ms-MruItemId":u}:{}))];case 1:return[4,(o=i.sent()).json()];case 2:return l=i.sent(),d=o.headers.get("Version"),[2,a.convertResponseJson(l,d)]}}))}))}t.restoreVersionOfScriptInternal=u,t.restoreVersionOfScript=function(e,t,r,n){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,u(s.buildScriptVersionRestorationUrl(e.id,t),r,n,e.mruItemId)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(74),s=r(9),a=r(75);t.saveScript=function(e,t,r,c){return n(this,void 0,void 0,(function(){return o(this,(function(n){if(!s.isScriptNameValid(e.name))throw new Error("Script name is invalid.");if(!s.isScriptDescriptionValid(e.description))throw new Error("Script description is invalid.");return[2,e.dateFirstPublished?a.updateScript(e,r,c):i.publishScript(e,t,r,c)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(5),a=r(0),c=r(4),u=r(1),l=r(3);function d(e,t,r,s,l,d){return o(this,void 0,void 0,(function(){var o,f,p;return i(this,(function(i){switch(i.label){case 0:return[4,u.makePostRequest(e,t,a.getAccessToken(),n(n(n({"x-ms-client-request-id":s,"X-UserSessionId":a.getSessionId()},l?{"x-ms-ShouldUpdateMru":l}:{}),d?{"x-ms-MruItemId":d}:{}),{"accept-language":r}))];case 1:return[4,(o=i.sent()).json()];case 2:return f=i.sent(),p=o.headers.get("Version"),[2,c.convertResponseJson(f,p)]}}))}))}t.publishScriptInternal=d,t.publishScript=function(e,t,r,n){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return a.inDevMode()?[4,l.pause(a.getDelay())]:[3,2];case 1:return o.sent(),[2,s.addScriptToLocalStorage(e)];case 2:return[2,d(a.buildScriptCrudUrl(),e,t,r,n,e.mruItemId)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var a=r(5),c=r(0),u=r(4),l=r(1),d=r(3);function f(e,t,r,s,a){return o(this,void 0,void 0,(function(){var o,d,f;return i(this,(function(i){switch(i.label){case 0:return[4,l.makePutRequest(e,t,c.getAccessToken(),n(n({"x-ms-client-request-id":r,"X-UserSessionId":c.getSessionId()},s?{"x-ms-ShouldUpdateMru":s}:{}),a?{"x-ms-MruItemId":a}:{}))];case 1:return[4,(o=i.sent()).json()];case 2:return d=i.sent(),f=o.headers.get("Version"),[2,u.convertResponseJson(d,f)]}}))}))}t.updateScriptInternal=f,t.updateScript=function(e,t,r){return o(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return n=e.id,e.dateFirstPublished,e.dateLastPublished,o=s(e,["id","dateFirstPublished","dateLastPublished"]),c.inDevMode()?[4,d.pause(c.getDelay())]:[3,2];case 1:return i.sent(),[2,a.updateScriptOnLocalStorage(n,o)];case 2:return[2,f(c.buildScriptCrudUrl(n),o,t,r,e.mruItemId)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(4),a=r(1),c=r(3);function u(e,t,r){return n(this,void 0,void 0,(function(){var n,c,u;return o(this,(function(o){switch(o.label){case 0:return[4,a.makePostRequest(e,t,i.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":i.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return c=o.sent(),u=n.headers.get("Version"),[2,s.convertResponseJsonArray(c,u)]}}))}))}function l(e,t){return n(this,void 0,void 0,(function(){var r,n,c;return o(this,(function(o){switch(o.label){case 0:return[4,a.makeGetRequest(e,i.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":i.getSessionId()})];case 1:return[4,(r=o.sent()).json()];case 2:return n=o.sent(),c=r.headers.get("Version"),[2,s.convertResponseJsonArray(n,c)]}}))}))}t.searchScripts=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return c.shouldUseApiV1()?[2,l(i.buildScriptSearchUrl(e),t)]:[2,u(i.buildScriptSearchUrl(e),e,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(9),a=r(0),c=r(4),u=r(1);function l(e,t,r,s,l){return o(this,void 0,void 0,(function(){var o,d,f;return i(this,(function(i){switch(i.label){case 0:return[4,u.makePutRequest(e,t,a.getAccessToken(),n(n({"x-ms-client-request-id":r,"X-UserSessionId":a.getSessionId()},s?{"x-ms-ShouldUpdateMru":s}:{}),l?{"x-ms-MruItemId":l}:{}))];case 1:return[4,(o=i.sent()).json()];case 2:return d=i.sent(),f=o.headers.get("Version"),[2,c.convertResponseJson(d,f)]}}))}))}t.updateScriptNameInternal=l,t.updateScriptName=function(e,t,r){return o(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){if(n=e.id,o=e.name,!s.isScriptNameValid(e.name))throw new Error("Script name is invalid.");return[2,l(a.buildUpdateScriptNameUrl(n),o,t,r,e.mruItemId)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(9),a=r(0),c=r(4),u=r(1);function l(e,t,r,s,l){return o(this,void 0,void 0,(function(){var o,d,f;return i(this,(function(i){switch(i.label){case 0:return[4,u.makePutRequest(e,t,a.getAccessToken(),n(n({"x-ms-client-request-id":r,"X-UserSessionId":a.getSessionId()},s?{"x-ms-ShouldUpdateMru":s}:{}),l?{"x-ms-MruItemId":l}:{}))];case 1:return[4,(o=i.sent()).json()];case 2:return d=i.sent(),f=o.headers.get("Version"),[2,c.convertResponseJson(d,f)]}}))}))}t.updateScriptContentsInternal=l,t.updateScriptContents=function(e,t,r){return o(this,void 0,void 0,(function(){var n;return i(this,(function(o){if(n=e.id,!s.isScriptDescriptionValid(e.description))throw new Error("Script description is invalid.");return[2,l(a.buildUpdateScriptContentsUrl(n),e,t,r,e.mruItemId)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),s=r(0),a=r(1),c=r(3);function u(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,a.makePutRequest(s.buildScriptShareUrl(e),!0,s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})];case 1:return[4,r.sent().text()];case 2:return[2,r.sent()]}}))}))}function l(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,a.makeGetRequest(s.buildScriptShareUrl(e),s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})];case 1:return[4,r.sent().text()];case 2:return[2,r.sent()]}}))}))}t.shareScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return s.inDevMode()?[4,c.pause(s.getDelay())]:[3,2];case 1:return r.sent(),[2,i.shareScriptToLocalStorage(e)];case 2:return c.shouldUseApiV1()?[2,l(e,t)]:[2,u(e,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),s=r(0),a=r(1),c=r(3);function u(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,a.makePutRequest(s.buildScriptShareUrl(e),!1,s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})]}))}))}function l(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,a.makeDeleteRequest(s.buildScriptShareUrl(e),s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})]}))}))}t.unshareScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return s.inDevMode()?[4,c.pause(s.getDelay())]:[3,2];case 1:return r.sent(),i.unshareScriptFromLocalStorage(e),[2];case 2:return c.shouldUseApiV1()?[2,l(e,t)]:[2,u(e,t)]}}))}))}}]);