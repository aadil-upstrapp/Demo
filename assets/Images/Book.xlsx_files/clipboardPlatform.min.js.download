var clipboardPlatform=function(e){var t={};function r(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=797)}({1:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return n})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return l})),r.d(t,"__awaiter",(function(){return d})),r.d(t,"__generator",(function(){return u})),r.d(t,"__createBinding",(function(){return f})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return g})),r.d(t,"__read",(function(){return m})),r.d(t,"__spread",(function(){return h})),r.d(t,"__spreadArrays",(function(){return b})),r.d(t,"__spreadArray",(function(){return y})),r.d(t,"__await",(function(){return S})),r.d(t,"__asyncGenerator",(function(){return C})),r.d(t,"__asyncDelegator",(function(){return v})),r.d(t,"__asyncValues",(function(){return E})),r.d(t,"__makeTemplateObject",(function(){return w})),r.d(t,"__importStar",(function(){return T})),r.d(t,"__importDefault",(function(){return _})),r.d(t,"__classPrivateFieldGet",(function(){return I})),r.d(t,"__classPrivateFieldSet",(function(){return P})),r.d(t,"__classPrivateFieldIn",(function(){return O}));var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}function s(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,a){return new(r||(r=Promise))((function(o,n){function i(e){try{c(a.next(e))}catch(e){n(e)}}function s(e){try{c(a.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))}function u(e,t){var r,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return i.label++,{value:n[1],done:!1};case 5:i.label++,a=n[1],n=[0];continue;case 7:n=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){i=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){i.label=n[1];break}if(6===n[0]&&i.label<o[1]){i.label=o[1],o=n;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(n);break}o[2]&&i.ops.pop(),i.trys.pop();continue}n=t.call(e,i)}catch(e){n=[6,e],a=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}var f=Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function g(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,s=n.length;i<s;i++,o++)a[o]=n[i];return a}function y(e,t,r){if(r||2===arguments.length)for(var a,o=0,n=t.length;o<n;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function C(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,o=r.apply(e,t||[]),n=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(e){o[e]&&(a[e]=function(t){return new Promise((function(r,a){n.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof S?Promise.resolve(r.value.v).then(c,l):d(n[0][2],r)}catch(e){d(n[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),n.shift(),n.length&&s(n[0][0],n[0][1])}}function v(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,o){t[a]=e[a]?function(t){return(r=!r)?{value:S(e[a](t)),done:"return"===a}:o?o(t):t}:o}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=g(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,o){(function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)})(a,o,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var L=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return L(t,e),t}function _(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}function P(e,t,r,a,o){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?o.call(e,r):o?o.value=r:t.set(e,r),r}function O(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},107:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var a={};t.promises=function(){return void 0===a.promises&&(a.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),a.promises}},108:function(e,t,r){"use strict";function a(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,r){e[t]=a()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=a(),r=e,n=t,i={},s=function(e,t,a){return function(e,t,r,a,n,i){o(e,"end",r);var s={sessionName:t,result:a?"success":"failure",message:i,marks:e},c=JSON.stringify(s);n(c)}(i,r,n,e,t,a)};return i.start=0,{mark:function(e){return function(e){return o(i,e,n)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=a},135:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var a=r(136),o={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return o},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,a.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),o=e}},136:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1);a.__exportStar(r(137),t),a.__exportStar(r(138),t)},137:function(e,t,r){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){a=e};t.isChangeGateEnabled=function(e){return!a||a.isChangeGateEnabled(e)}},138:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},139:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var a=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(a=function(){return self.performance.now()}),function(r){var o=a(),n=r;return{reset:function(e){null!=e&&(n=e),o=a()},stop:function(r){var i=a()-o,s=JSON.stringify({Target:n,Duration:i.toFixed(t),StopInfo:r});e(s)}}}}},140:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var a=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=a},141:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,a=r.crypto||r.msCrypto;if(a){t.crypto=!0;try{return a.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var o=!1,n=r.performance;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var i=0;i<e.length;i+=1){try{if(o){t.perfNow=!0;var s=Math.floor(100*n.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)})),t]}},142:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var a=r(97);t.utils=a;var o=r(66);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return o.ConsoleLogger}});var n=r(107);t.browserSupport=n;var i=r(108);t.perfWatch=i;var s=r(135);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var c=r(139);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return c.initStopwatchFactory}});var l=r(140);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return l.TelemetryCollector}});var d=r(141);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return d.getNewGuid}});var u=r(142);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return u.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return u.TextAreaInputMode}})},3:function(e,t,r){"use strict";var a={};r.r(a),r.d(a,"sharedClipboardSettingsVariableName",(function(){return le})),r.d(a,"defaultPromiseTimeoutInMinutes",(function(){return fe})),r.d(a,"getSharedClipboardSettings",(function(){return pe})),r.d(a,"initializeSharedClipboardSettingsFromWindow",(function(){return ge})),r.d(a,"initializeSharedClipboardSettings",(function(){return me})),r.d(a,"createEmptySharedClipboardSettings",(function(){return be}));var o={};r.r(o),r.d(o,"divTagName",(function(){return Ot})),r.d(o,"preTagName",(function(){return At})),r.d(o,"tableTagName",(function(){return jt})),r.d(o,"trTagName",(function(){return xt})),r.d(o,"tdTagName",(function(){return Dt})),r.d(o,"ccpTimestampHtmlCustomAttributeName",(function(){return Jt})),r.d(o,"minCcpTimestampHtmlCustomAttributeValue",(function(){return kt})),r.d(o,"ensureOneLFPerNewLine",(function(){return zt})),r.d(o,"trimToLength",(function(){return Ht})),r.d(o,"createTextHtmlFromTextPlain",(function(){return Vt})),r.d(o,"createHtmlItemFromTextPlain",(function(){return Bt})),r.d(o,"createPlainTextFromHtml",(function(){return Gt})),r.d(o,"isContainsTimestampWrapper",(function(){return qt})),r.d(o,"addClipboardWrapperForEdge",(function(){return Xt})),r.d(o,"getFragmentFromTextHtml",(function(){return Qt})),r.d(o,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",(function(){return Yt})),r.d(o,"getExternalSource",(function(){return $t})),r.d(o,"encodeAngleBrackets",(function(){return Zt})),r.d(o,"wrapContentWithTagAndAttributes",(function(){return er}));var n,i=r(2);function s(){return n}function c(e){if(!e)throw new Error("The 'logger' argument is missing");n=i.ULS.getFromExternalLogger(e)}var l,d,u,f,p,g=r(1);function m(e,t){return h(e,[t])}function h(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(f||(f={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(p||(p={}));var b=function(e){function t(r,a,o){var n=this,c=t.augmentParameterValue(r);if((n=e.call(this,c)||this).name=t.augmentParameterValue(a),n.errorName=n.name,n.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '".concat(n.name,"': ").concat(c)):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: ".concat(c)),o){n.innerError=o;var l=n.innerError.message;l||(l=n.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: ".concat(d))}return n.stack||(n.stack=(new Error).stack),n}return Object(g.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),y=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return Object(g.__extends)(t,e),t}(b),S=function(e){function t(r,a,o){var n=this,i=b.augmentParameterValue(a),s=t.getDefaultMessage(i),c=b.augmentParameterValue(r);return 0===c.length&&(c=s),(n=e.call(this,c,"MissingArgumentError",o)||this).name=i,n}return Object(g.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '".concat(e,"'")),t},t}(b),C=function(e){function t(r,a,o,n){var i=this,s=b.augmentParameterValue(a),c=o;c||(c="");var l=t.getDefaultMessage(s,c),d=b.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",n)||this).name=s,i.value=c,i}return Object(g.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '".concat(e,"' argument: '").concat(t,"'"):"Invalid argument"},t}(b),v=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(g.__extends)(t,e),t}(b),E=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return Object(g.__extends)(t,e),t}(b),w=function(e){function t(t,r,a,o,n){return e.call(this,"".concat(t,". Data version: ").concat(r,", Infra version: ").concat(a,", blockMismatchDataVersion: ").concat(o),"MismatchVersionError",n)||this}return Object(g.__extends)(t,e),t}(b),L=function(e){function t(t,r,a,o){return e.call(this,"".concat(t,". Duration in clipboard (ms) : ").concat(r,", TTL (ms): ").concat(a),"TTLClipboardDataError",o)||this}return Object(g.__extends)(t,e),t}(b),T=function(e){function t(t,r,a,o){return e.call(this,"".concat(t,". Data User Hash : ").concat(r,", infra User Hash: ").concat(a),"UserHashMismatchError",o)||this}return Object(g.__extends)(t,e),t}(b),_=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return Object(g.__extends)(t,e),t}(b);function I(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var P=function(e){function t(t,r,a,o,n){var i=e.call(this,r||"reason=".concat(t),a,o)||this;return i.reason=t,n&&(i.errorName=n),i}return Object(g.__extends)(t,e),t}(b),O=function(e){function t(t,r,a){return e.call(this,t,r,"CopyError",a,I(t,u))||this}return Object(g.__extends)(t,e),t}(P),A=function(e){function t(t,r,a){return e.call(this,t,r,"PasteError",a,I(t,f))||this}return Object(g.__extends)(t,e),t}(P),j=function(e){function t(t,r,a){return e.call(this,t,r,"CancelError",a,I(t,p))||this}return Object(g.__extends)(t,e),t}(P),x=function(e){function t(t,r,a){return e.call(this,t,r,"ClipboardPlatformError",a,I(t,d))||this}return Object(g.__extends)(t,e),t}(P),D=function(e){function t(t,r,a){return e.call(this,t,r,"SharedClipboardError",a,I(t,d))||this}return Object(g.__extends)(t,e),t}(P);function M(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," threw an exception: ").concat(e.message)),r||(r=new v(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," is empty"))})),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function W(){return R}var R={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:""},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:""}},U={};function F(){U={}}var N=new RegExp("(\\bTrident/| MSIE )"),J=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function k(){if(void 0===U.isIEProperty){U.isIEProperty=!1;var e=W();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(N);r&&2===r.length&&(U.isIEProperty=!0)}}}return U.isIEProperty}function z(){if(void 0===U.isEdgeProperty){U.isEdgeProperty=!1,U.isEdgeWithTextHtmlClipboardSupportProperty=!1,U.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=W();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(J);if(r&&2===r.length){U.isEdgeProperty=!0;var a=Number(r[1]);isNaN(a)||(a>=16.16299&&(U.isEdgeWithTextHtmlClipboardSupportProperty=!0),a>=17.17123&&(U.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return U.isEdgeProperty}function H(){return z()&&U.isEdgeWithTextHtmlClipboardSupportProperty}function V(){return z()&&U.isEdgeVersionWithTextHtmlWrapperSupportProperty}function B(){return G}var G={postMessage:function(e,t,r,a){e.postMessage(t,r,a)}},K=function(e,t,r,a){return void 0===a&&(a=!1),e.addEventListener(t,r,a),function(){e.removeEventListener(t,r,a)}};function q(){return{items:{}}}var X,Q,Y,$,Z=(X={items:{}},{getData:function(){return X},getItem:function(e){},setItem:function(e,t){throw new v("Cannot set an item with clipboard data format '".concat(e,"' in an immutable empty clipboard (content is ").concat(t&&t.length>0?"not ":"","empty)"))},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return ce(void 0)}});function ee(){return Z}function te(e){return e&&e.items?Object.keys(e.items).length:0}function re(e){return te(e&&e.getData())}function ae(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return oe(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new C("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return ce(t)}}}function oe(e,t){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new C("","clipboardItemsData.items");return e.items[t]}function ne(e,t){if(!e||0===e.length||!t||!t.trim())return"";var r=void 0;return e.forEach((function(e){e.clipboardDataFormat===t&&(r=e.data)})),r||""}function ie(e){return ne(e,"text/plain")}function se(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:"text/plain",data:""}),t}function ce(e){var t=[];if(0===te(e))return t;for(var r in e.items){var a=oe(e,r);a||(a="");var o={clipboardDataFormat:r,data:a,deferred:!1};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(Q||(Q={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink"}(Y||(Y={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}($||($={}));var le="sharedClipboardSettings",de=be(),ue=!1,fe=2;function pe(){if(!ue)throw new v("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return de}function ge(){ue=!1,function(){if(!window||!(le in window))return de=be(),void(ue=!0);var e=window[le];if(!e||"object"!=typeof e)return de=be(),void(ue=!0);he(e)}()}function me(e){ue=!1,he(e)}function he(e){if(!e)throw new S("","sharedClipboardSettingsCandidate");var t=be();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return de=t,void(ue=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),de=t,void(ue=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,a=r.indexOf("-");a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){s().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],de=t,void(ue=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){s().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],de=t,void(ue=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],de=t,void(ue=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' or '").concat(r,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],de=t,void(ue=!0)}t.whitelistOriginComponents=!0,de=t,ue=!0}function be(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:fe,remoteLoggerPath:""}}function ye(){var e="";return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=""):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: ".concat(!!window,". is window.location exist: ").concat(window&&!!window.location,". is window.location.origin exist ").concat(window&&window.location&&!!window.location.origin,". is window.location.protocol exist ").concat(window&&window.location&&!!window.location.protocol,". is window.location.hostname exist ").concat(window&&window.location&&!!window.location.hostname,". is window.location.port exist ").concat(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var Se,Ce,ve=new RegExp("^\\d+$"),Ee=!1;function we(e){if(!e)throw new S("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new C("Missing protocol","origin",e);if(1===r.length)throw new C("Missing domain","origin",e);if(r.length>2)throw new C("'".concat("://","' should appear once"),"origin",e);var a=r[1];if(!a)throw new C("Missing domain","origin",e);if(t=r[0]+"://",!(r=(a=a.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new C("Missing domain","origin",e);if(r.length>2)throw new C("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new C("The last part of the origin should be the domain","origin",e);if(!(r=a.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new C("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new C("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=a=r[0].trim(),2===r.length){var o=r[1].trim(),n=ve.exec(o);if(!n||1!==n.length)throw new C("Invalid port number","origin",e);var c=Number(o);if(isNaN(c))throw new C("Invalid port number","origin",e);t+=":"+o}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '".concat(e,"'; validated origin = '").concat(t,"'")),t}function Le(e){Oe();var t=we(e),r=t.split("://");if(!r||2!==r.length||!r[0]||!r[1])throw new C("Invalid origin","parentOrigin",e);var a=pe(),o="";if(a.whitelistOriginComponents){var n=r[0]+"://";if(!(r=r[1].split("."))||r.length<2||!r[0])throw new C("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),o=n+r.join(".")}else o=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '".concat(e,"'; Shared Clipboard iframe origin = '").concat(o,"' components=").concat(JSON.stringify(r))),o}function Te(e){Oe();var t=we(e),r=we(ye().origin);if(t===r)return t;if(!pe().whitelistOriginComponents)throw new v("validateOriginForReceivedMessage: Caller origin '".concat(e,"' doesn't match the current window's origin '").concat(r,"'"));var a=_e(t),o=_e(r);if(a.protocol!==o.protocol)throw new v("validateRemoteWindowOrigin: Caller origin's protocol '".concat(a.protocol,"' doesn't match the current window origin's protocol '").concat(o.protocol,"'"));if(a.environment!==o.environment)throw new v("validateRemoteWindowOrigin: Caller origin's environment '".concat(a.environment,"' doesn't match the current window origin's environment '").concat(o.environment,"'"));return t}function _e(e){Oe();var t=e.split("://",2),r=t[0],a=Ie(t[1]),o={protocol:r};if(o.environment=Pe(e,a,Ce),a.length<=o.environment.length+1)throw new C("Missing app component","origin",e);if("."!==a.charAt(o.environment.length))throw new C("Missing a domain separator after the environment component","origin",e);var n=a.substr(o.environment.length+".".length);if(o.app=Pe(e,n,Se),o.app.length<n.length&&"-"!==n.charAt(o.app.length))throw new C("When the Office Online app name is not the domain prefix, '".concat("-","' should precede it"),"origin",e);return o}function Ie(e){if(!e)throw new S("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function Pe(e,t,r){if(!t)throw new S("","reversedValidatedHostname");if(!r)throw new S("","reversedStringsToLengthMap");var a=t.length,o=Object.keys(r).filter((function(e){var o=r[e];return o<=a&&t.substr(0,o)===e}));if(o&&o.length>0)return Ie(o[0]);throw new C("Invalid origin","validatedOrigin",e)}function Oe(){if(!Ee){var e=pe();e.whitelistOriginComponents&&(Se=Ae(e.sharedClipboardHostingApps),Ce=Ae(e.sharedClipboardHostingEnvironments),Ee=!0)}}function Ae(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[Ie(e)]=e.length})),t):t}function je(e,t){return null==e||1===e||null==t||e!==t}function xe(){return We()}function De(){return We()}function Me(e){if(!e)throw new S("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new C("","id");return t}function We(){return(Math.random()+1).toString(36).substring(7)}function Re(e,t,r,a,o){var n={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:o};return Ne(n),n}var Ue=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function Fe(e){return"get"===e||"set"===e||"init"===e}var Ne=function(e){if(!e)throw new S("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if(!e.destination)throw new S("","destination");if(!Fe(e.operationCode))throw new C("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new C("'".concat(e.operationCode,"' expects no clipboard items"),"clipboardItemsData")};function Je(e,t,r,a,o){var n={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:o};return ke(n),n}var ke=function(e){if(!e)throw new S("","clipboardOperationResultMessage");for(var t=!1,r=0,a=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<a.length;r++){var o=a[r];if(e.hasOwnProperty(o)){t=!0;break}}if(!t)throw new y("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw s().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Missing argument 'id'. keys: ".concat(JSON.stringify(Object.keys(e)),", isConstructorObject: ").concat(e.constructor===Object,", operationCode: ").concat(e.operationCode,", id: ").concat(e.id,", failed: ").concat(e.failed,", error: ").concat(e.error,".")),new S("","id");if(!e.operationCode)throw new S("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new C("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new C("A failed '".concat(e.operationCode,"' operation expects a non-empty error argument"),"error");if(e.clipboardItemsData)throw new C("A failed '".concat(e.operationCode,"' operation does not expect a clipboardItemsData argument"),"clipboardItemsData")}else{if(e.error)throw new C("'".concat(e.operationCode,"' expects an empty error argument"),"error");if("unknownresult"===e.operationCode)throw new C("'".concat(e.operationCode,"' can only be used with a failure message"),"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new C("'".concat(e.operationCode,"' expects a clipboardItems argument"),"clipboardItemsData")}else if(e.clipboardItemsData)throw new C("'".concat(e.operationCode,"' expects no clipboardItemsData argument"),"clipboardItemsData")};function ze(e){if(!e||0===e.trim().length)throw new C("","className",e);return function(){var t=!1;function r(t){return"".concat(e,":").concat(t,": already disposed")}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new v(r(e))}}}()}var He=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=ze("".concat(e))}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '".concat(t.clipboardStrategyType,"' was initialized.")),Promise.resolve(t)}),(function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '".concat(t.clipboardStrategyType,"'. Error: ").concat(i.utils.getStringifiedError(e))),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new x(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new x(d.SetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").set"),e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new x(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new x(d.GetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").get"),e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(ee(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new x(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new x(d.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),Ve=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Be(e){var t=e;return t&&0!==t.trim().length||(t=xe()),new Xe(t)}function Ge(){return Ve?window.performance.now():Date.now()}function Ke(e){return Ve?new Date(e+window.performance.timing.navigationStart):new Date(e)}function qe(e,t,r){if(!r)throw new S("","creationTimestamp");return"".concat(e?"Fulfilled":"Still unfulfilled"," after ").concat(e?t?t-r:"?":Ge()-r,"ms")}var Xe=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Me(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Ge(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' on ").concat(Ke(this.creationTimestamp))),this.promise=new Promise((function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #".concat(r.sequenceId," with id '").concat(r.id,"' on ").concat(Ke(Ge()))),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Ge(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #".concat(this.sequenceId," with id '").concat(this.id,"' as fulfilled (").concat(this.rejected?"rejected":"resolved","). ").concat(qe(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"'")),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"' since it was ").concat(this.rejected?"rejected":"resolved"," already on ").concat(Ke(this.fulfillmentTimestamp),". ").concat(qe(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))),this.isFulfilled},e.sequenceId=0,e}();function Qe(){return new Ye}var Ye=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=Me(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '".concat(e,"'.")),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '".concat(e,"'."))},e.prototype.addNewPromise=function(e){var t=Be(e);if(this.getDeferredPromise(t.id))throw new C("A deferred promise already exists in the cache for the specified id","id",t.id);var r=Me(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '".concat(t.id,"'.")),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=Me(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '".concat(e,"'."))}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '".concat(e,"' since this id is not associated with an existing deferred promise."))},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing ".concat(this.getLength()," items from the cache")),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '".concat(e,"' with this exception: ").concat(t.message,". Ignoring."))}}this.deferredResultMessagePromiseCache={}},e}();function $e(e){if(!e)throw new S("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new S("","incomingMessage");if(!t)throw new S("","validator");if(0===e.length)throw new C("An empty message is invalid","incomingMessage");var r,a=e.trim();if(0===a.length)throw new C("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(a)}catch(t){throw new C("Deserialization failed","incomingMessage","Contains ".concat(e.length.toString()," characters"),t)}if(!r)throw new C("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function Ze(e){if(!e)throw new S("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new S("","outgoingMessage");if(!t)throw new S("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new C("Serialization failed","outgoingMessage","".concat(Object.keys(e).length," properties"),t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is ".concat(t.length)),t}(e)}(t,e)}}}function et(e){if(!e)throw new S("","remoteWindow");if(!("window"in e)||!e.window)throw new S("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new S("","remoteWindow.windowOrigin");var t=Te(e.windowOrigin);return{window:e.window,windowOrigin:t}}var tt=function(){function e(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=ze(a)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(M([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new v(t)}this.sender.postMessage(e)},e}();function rt(){return at}var at={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function ot(e,t,r){return new it(e,t,r)}function nt(e,t,r){return new it(e,t,r)}var it=function(){function e(e,t,r){var a=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return a.onMessageReceived(e)},!e)throw new S("","deserializer");if(!t)throw new S("","handler");if(!r)throw new S("","windowRPC");this.disposableImplementationExtension=ze("WindowRPCReceiverInternal"),this.remoteWindow=et(r.remoteWindow),rt().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(rt().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. ".concat(i.utils.getStringifiedError(e)));try{this.handler.handleDeserializationError(e)}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. ".concat(i.utils.getStringifiedError(e)))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(i.utils.getStringifiedError(e)))}))}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(i.utils.getStringifiedError(e)))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function st(e,t){return new lt(e,t)}function ct(e,t){return new lt(e,t)}var lt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S("","serializer");if(!t)throw new S("","windowRPC");this.disposableImplementationExtension=ze("WindowRPCSenderInternal"),this.remoteWindow=et(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new S("","outgoingMessage");if(!this.remoteWindow.window)throw new v("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new v("The remote window does not support postMessage");var t=this.serializer.serialize(e);B().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function dt(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function ut(e){return"OfficeOnlineCCP_Data_"+e}function ft(e){return"OfficeOnlineCCP_Metadata_"+e}function pt(e){return ft(e)+"_LocalStorageChangedFlag"}var gt,mt=function(){this.copyStatus=gt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},ht=function(){function e(){this.startTime=i.perfWatch.timeStamp()}return e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: ".concat(e,", pasteId: ").concat(this.id,", timeMS: ").concat(t.toFixed())},e}();function bt(){return{}}function yt(e){var t=void 0;return e&&e.lastCopy&&(t=Object(g.__assign)({},e.lastCopy)),{lastCopy:t}}function St(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '".concat(Q.LocalStorage,"'"));var t=new Ct(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(gt||(gt={}));var Ct=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new x(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new x(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=Q.LocalStorage,this.disposableImplementationExtension=ze("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='".concat(e?e.id:"","'"));var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(ee());try{var r=JSON.parse(t);if(!r||0===te(r))return Promise.resolve(ee());var a=ae(r);return Promise.resolve(a)}catch(e){return Promise.resolve(ee())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count=".concat(re(e),"'; commandParameters.id='").concat(t?t.id:"","'")),0===re(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r="".concat(this.localStorageKey+"_LocalStorageChangedFlag"),a=xe();return s().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = ".concat(r,". eventFlagValue = ").concat(a)),localStorage.setItem(r,a),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function vt(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '".concat(l.LocalStorage,"' with localStorageKey: '").concat(e,"'")),(new Et).initialize(St(e))}var Et=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(g.__extends)(t,e),t}(He),wt=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ".concat(e.key,". localStorageKeyToWatch = ").concat(this.localStorageKeyToWatch,". lastLocalStorageValue = ").concat(this.lastLocalStorageValue)),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ".concat(e.lastLocalStorageValue))}),(function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ".concat(this.lastLocalStorageValue,". currentLocalStorageValue = ").concat(e)),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),Promise.resolve();var r=Be(),a=new Date,o=setInterval((function(){var n=(new Date).getTime()-a.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ".concat(a,". elapseTime = ").concat(n,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),t.isLocalStorageValueChanged()?(clearInterval(o),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ".concat(a,". elapseTime = ").concat(n,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.resolve()):n>e&&(clearInterval(o),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ".concat(a,". elapseTime = ").concat(n,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.reject())}),200);return r.promise},e}(),Lt="\n",Tt=new RegExp("(".concat(Lt).concat("\r",")|(").concat("\r").concat(Lt,")|(").concat("\r",")"),"g"),_t=new RegExp("(".concat("\t",")"),"g"),It=new RegExp("<","g"),Pt=new RegExp(">","g"),Ot="div",At="pre",jt="table",xt="tr",Dt="td",Mt="\x3c!--EndFragment--\x3e",Wt="\x3c!--StartFragment--\x3e".length,Rt=Mt.length,Ut="Version:0.9".concat(Lt,"StartHTML:0000000").concat(100).concat(Lt,"EndHTML:{EndHTML0}").concat(Lt,"StartFragment:0000000").concat(134).concat(Lt,"EndFragment:{EndFragm}").concat(Lt,"<html>").concat(Lt,"<body>").concat(Lt).concat("\x3c!--StartFragment--\x3e").concat(Lt),Ft="".concat(Mt).concat(Lt,"</body>").concat(Lt,"</html>"),Nt="</html>".length,Jt="data-ccp-timestamp",kt=0;function zt(e){return e?e.replace(Tt,Lt):e}function Ht(e){return e?e.length<=10240?e:e.substr(0,10240):""}function Vt(e){var t,r=Zt(e),a=function(e){return e?e.replace(Tt,"</".concat(Dt,"></").concat(xt,"><").concat(xt,"><").concat(Dt,">")):e}((t=r)?t.replace(_t,"</".concat(Dt,"><").concat(Dt,">")):t);return"<".concat(jt,"><").concat(xt,"><").concat(Dt,">").concat(a,"</").concat(Dt,"></").concat(xt,"></").concat(jt,">")}function Bt(e,t,r){if(r!==kt&&!r)throw new S("","timestamp");if(isNaN(r))throw new C("","timestamp",r.toString());return Xt(function(e,t,r){return"<".concat(e," ").concat(Jt,"='").concat(r,"'>").concat(t,"</").concat(e,">")}(e,Vt(t),r))}function Gt(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var a=Kt(r[0]);t.push(a);for(var o=1;o<r.length;o+=1){t.push("\r"),t.push(Lt);var n=Kt(r[o]);t.push(n)}}return t.join("")}function Kt(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var a=1;a<r.length;a+=1)t.push("\t"),t.push(r[a].innerText)}return t.join("")}function qt(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Jt)}function Xt(e){if(!z()||V())return e;var t="0000000000".length,r=Ut.length+e.length+Ft.length,a=(r-Ft.length).toString();if(a.length<t&&(a="0000000000".substr(0,t-a.length)+a),a.length!==t){var o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ".concat(a.length," but it should be ").concat(t);throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new x(d.UnexpectedClipboardTextHtmlContentLength,o)}var n=(r-Nt).toString();if(n.length<t&&(n="0000000000".substr(0,t-n.length)+n),n.length!==t){o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ".concat(n.length," but it should be ").concat(t);throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new x(d.UnexpectedClipboardTextHtmlContentLength,o)}var c=Ut.replace("{EndHTML0}",n).replace("{EndFragm}",a)+e+Ft;return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of ".concat(c.length," differs from the expected length of ").concat(r)),c}function Qt(e){if(!e)return"";if(!e.trim())return e;var t=e.indexOf("\x3c!--StartFragment--\x3e"),r=e.indexOf(Mt);if(t<0||r<0||t>r)return e;var a=t+Wt,o=r-a,n=e.indexOf("\x3c!--StartFragment--\x3e",a),i=e.indexOf(Mt,r+Rt);return n>=0||i>=0?e:e.substr(a,o)}function Yt(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new S("","attributeName");var r=new RegExp("".concat(t,"=['\"](\\d+)['\"]"),"i").exec(e);if(!r||r.length<2)return;return r[1]}(e,Jt);if(t&&t.trim()){var r=Number(t);if((r||r===kt)&&!isNaN(r))return r}}function $t(e){if(e&&e.trim()){var t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){for(var t=e.getElementsByTagName("meta"),r=0;r<t.length;r+=1){var a=t[r];if("ProgId"===a.getAttribute("name")){var o=a.getAttribute("content");if(null!==o){if(o.length>64)return void s().ULS.shipAssertTag(595683460,i.LogCategory.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(o.startsWith("Word"))return"Word Desktop";if(o.startsWith("Excel"))return"Excel Desktop";if(o.startsWith("PowerPoint"))return"PowerPoint Desktop";if(o.startsWith("OneNote"))return"OneNote Desktop";s().ULS.traceTag(595683457,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}return}(t);if(void 0!==r)return r;var a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;var t=e.body.children[0];if(null!=t&&null!=t.classList)for(var r=0;r<t.classList.length;r+=1){var a=t.classList[r];if(a.startsWith("SCXO"))return"OneNote Online";if(a.startsWith("SCXP"))return"PowerPoint Online";if(a.startsWith("SCXW"))return"Word Online"}return}(t);return void 0!==a?a:function(e){if(null===e)return!1;var t=e.getElementsByTagName("b");if(0===t.length)return!1;var r=t[0];if(null!=r&&null!=r.id&&null!=r.id.startsWith&&r.id.startsWith("docs-internal-guid-"))return!0;return!1}(t)?"Google Docs":void 0}}function Zt(e){return e?e.replace(It,"&lt;").replace(Pt,"&gt;"):""}function er(e,t,r){var a="";return r&&(a=Object.keys(r).reduce((function(e,t){return t?"".concat(e," ").concat(t,"='").concat(r[t],"'"):e}),"")),"<".concat(t).concat(a,">").concat(e,"</").concat(t,">")}r.d(t,"fc",(function(){return s})),r.d(t,"Eb",(function(){return c})),r.d(t,"Gb",(function(){return m})),r.d(t,"Hb",(function(){return h})),r.d(t,"a",(function(){return b})),r.d(t,"D",(function(){return y})),r.d(t,"B",(function(){return S})),r.d(t,"t",(function(){return C})),r.d(t,"u",(function(){return v})),r.d(t,"M",(function(){return E})),r.d(t,"A",(function(){return w})),r.d(t,"K",(function(){return L})),r.d(t,"N",(function(){return T})),r.d(t,"L",(function(){return _})),r.d(t,"b",(function(){return P})),r.d(t,"m",(function(){return O})),r.d(t,"H",(function(){return A})),r.d(t,"c",(function(){return j})),r.d(t,"e",(function(){return x})),r.d(t,"J",(function(){return D})),r.d(t,"bc",(function(){return M})),r.d(t,"Db",(function(){return F})),r.d(t,"Lb",(function(){return k})),r.d(t,"Ib",(function(){return z})),r.d(t,"Kb",(function(){return H})),r.d(t,"Jb",(function(){return V})),r.d(t,"Ab",(function(){return B})),r.d(t,"jb",(function(){return""})),r.d(t,"Xb",(function(){return" "})),r.d(t,"Wb",(function(){return"."})),r.d(t,"Ub",(function(){return"1"})),r.d(t,"Vb",(function(){return"1"})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return"copy"})),r.d(t,"p",(function(){return"cut"})),r.d(t,"E",(function(){return"paste"})),r.d(t,"k",(function(){return"copy"})),r.d(t,"q",(function(){return"cut"})),r.d(t,"F",(function(){return"paste"})),r.d(t,"P",(function(){return K})),r.d(t,"hb",(function(){return"text/plain"})),r.d(t,"ib",(function(){return"Text"})),r.d(t,"ec",(function(){return"text/html"})),r.d(t,"Cb",(function(){return"image/png"})),r.d(t,"Sb",(function(){return"metadata/is-last-copy-was-external"})),r.d(t,"Tb",(function(){return"metadata/is-last-copy-was-external-XLO-source"})),r.d(t,"Pb",(function(){return"metadata/chrome-extension-id"})),r.d(t,"Rb",(function(){return"metadata/ccp-infra-version"})),r.d(t,"Qb",(function(){return"copyId"})),r.d(t,"Ob",(function(){return"metadata/additional-signature-data-attributes"})),r.d(t,"qb",(function(){return q})),r.d(t,"sb",(function(){return ee})),r.d(t,"ob",(function(){return te})),r.d(t,"nb",(function(){return re})),r.d(t,"R",(function(){return ae})),r.d(t,"mb",(function(){return oe})),r.d(t,"lb",(function(){return ne})),r.d(t,"pb",(function(){return ie})),r.d(t,"tb",(function(){return se})),r.d(t,"g",(function(){return Q})),r.d(t,"r",(function(){return Y})),r.d(t,"f",(function(){return d})),r.d(t,"n",(function(){return u})),r.d(t,"I",(function(){return f})),r.d(t,"d",(function(){return p})),r.d(t,"s",(function(){return $})),r.d(t,"xb",(function(){return Le})),r.d(t,"jc",(function(){return Te})),r.d(t,"C",(function(){return 1})),r.d(t,"dc",(function(){return je})),r.d(t,"bb",(function(){return xe})),r.d(t,"U",(function(){return De})),r.d(t,"kb",(function(){return Me})),r.d(t,"S",(function(){return Re})),r.d(t,"z",(function(){return Ue})),r.d(t,"Nb",(function(){return Fe})),r.d(t,"hc",(function(){return Ne})),r.d(t,"T",(function(){return Je})),r.d(t,"ic",(function(){return ke})),r.d(t,"h",(function(){return He})),r.d(t,"V",(function(){return Be})),r.d(t,"W",(function(){return Qe})),r.d(t,"X",(function(){return ze})),r.d(t,"ab",(function(){return $e})),r.d(t,"cb",(function(){return Ze})),r.d(t,"Fb",(function(){return"initmessageid"})),r.d(t,"gc",(function(){return"unknownmessageid"})),r.d(t,"Yb",(function(){return"CreatorOrigin"})),r.d(t,"yb",(function(){return et})),r.d(t,"O",(function(){return tt})),r.d(t,"fb",(function(){return ot})),r.d(t,"db",(function(){return nt})),r.d(t,"gb",(function(){return st})),r.d(t,"eb",(function(){return ct})),r.d(t,"v",(function(){return"_LocalStorageChangedFlag"})),r.d(t,"Mb",(function(){return dt})),r.d(t,"ub",(function(){return ut})),r.d(t,"vb",(function(){return ft})),r.d(t,"wb",(function(){return pt})),r.d(t,"l",(function(){return mt})),r.d(t,"G",(function(){return ht})),r.d(t,"o",(function(){return gt})),r.d(t,"rb",(function(){return bt})),r.d(t,"Q",(function(){return yt})),r.d(t,"zb",(function(){return ye})),r.d(t,"Z",(function(){return vt})),r.d(t,"x",(function(){return Et})),r.d(t,"Y",(function(){return St})),r.d(t,"w",(function(){return Ct})),r.d(t,"y",(function(){return wt})),r.d(t,"Zb",(function(){return"usid"})),r.d(t,"ac",(function(){return"WacCluster"})),r.d(t,"Bb",(function(){return o})),r.d(t,"cc",(function(){return a}))},404:function(e,t,r){
/*! @license DOMPurify 2.3.9 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.9/LICENSE */
e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,o,n){return(a=r()?Reflect.construct:function(e,r,a){var o=[null];o.push.apply(o,r);var n=new(Function.bind.apply(e,o));return a&&t(n,a.prototype),n}).apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var i=Object.hasOwnProperty,s=Object.setPrototypeOf,c=Object.isFrozen,l=Object.getPrototypeOf,d=Object.getOwnPropertyDescriptor,u=Object.freeze,f=Object.seal,p=Object.create,g="undefined"!=typeof Reflect&&Reflect,m=g.apply,h=g.construct;m||(m=function(e,t,r){return e.apply(t,r)}),u||(u=function(e){return e}),f||(f=function(e){return e}),h||(h=function(e,t){return a(e,o(t))});var b,y=P(Array.prototype.forEach),S=P(Array.prototype.pop),C=P(Array.prototype.push),v=P(String.prototype.toLowerCase),E=P(String.prototype.match),w=P(String.prototype.replace),L=P(String.prototype.indexOf),T=P(String.prototype.trim),_=P(RegExp.prototype.test),I=(b=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return h(b,t)});function P(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return m(e,t,a)}}function O(e,t,r){r=r||v,s&&s(e,null);for(var a=t.length;a--;){var o=t[a];if("string"==typeof o){var n=r(o);n!==o&&(c(t)||(t[a]=n),o=n)}e[o]=!0}return e}function A(e){var t,r=p(null);for(t in e)m(i,e,[t])&&(r[t]=e[t]);return r}function j(e,t){for(;null!==e;){var r=d(e,t);if(r){if(r.get)return P(r.get);if("function"==typeof r.value)return P(r.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var x=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),M=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),W=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),U=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=u(["#text"]),N=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),k=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=f(/\{\{[\w\W]*|[\w\W]*\}\}/gm),V=f(/<%[\w\W]*|[\w\W]*%>/gm),B=f(/^data-[\-\w.\u00B7-\uFFFF]/),G=f(/^aria-[\-\w]+$/),K=f(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q=f(/^(?:\w+script|data):/i),X=f(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=f(/^html$/i),Y=function(){return"undefined"==typeof window?null:window},$=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null;r.currentScript&&r.currentScript.hasAttribute("data-tt-policy-suffix")&&(a=r.currentScript.getAttribute("data-tt-policy-suffix"));var o="dompurify"+(a?"#"+a:"");try{return t.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y(),a=function(e){return t(e)};if(a.version="2.3.9",a.removed=[],!r||!r.document||9!==r.document.nodeType)return a.isSupported=!1,a;var n=r.document,i=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,d=r.Element,f=r.NodeFilter,p=r.NamedNodeMap,g=void 0===p?r.NamedNodeMap||r.MozNamedAttrMap:p,m=r.HTMLFormElement,h=r.DOMParser,b=r.trustedTypes,P=d.prototype,Z=j(P,"cloneNode"),ee=j(P,"nextSibling"),te=j(P,"childNodes"),re=j(P,"parentNode");if("function"==typeof c){var ae=i.createElement("template");ae.content&&ae.content.ownerDocument&&(i=ae.content.ownerDocument)}var oe=$(b,n),ne=oe?oe.createHTML(""):"",ie=i,se=ie.implementation,ce=ie.createNodeIterator,le=ie.createDocumentFragment,de=ie.getElementsByTagName,ue=n.importNode,fe={};try{fe=A(i).documentMode?i.documentMode:{}}catch(e){}var pe={};a.isSupported="function"==typeof re&&se&&void 0!==se.createHTMLDocument&&9!==fe;var ge,me,he=H,be=V,ye=B,Se=G,Ce=q,ve=X,Ee=K,we=null,Le=O({},[].concat(o(x),o(D),o(M),o(R),o(F))),Te=null,_e=O({},[].concat(o(N),o(J),o(k),o(z))),Ie=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Oe=null,Ae=!0,je=!0,xe=!1,De=!1,Me=!1,We=!1,Re=!1,Ue=!1,Fe=!1,Ne=!1,Je=!0,ke=!0,ze=!1,He={},Ve=null,Be=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ge=null,Ke=O({},["audio","video","img","source","image","track"]),qe=null,Xe=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Qe="http://www.w3.org/1998/Math/MathML",Ye="http://www.w3.org/2000/svg",$e="http://www.w3.org/1999/xhtml",Ze=$e,et=!1,tt=["application/xhtml+xml","text/html"],rt="text/html",at=null,ot=i.createElement("form"),nt=function(e){return e instanceof RegExp||e instanceof Function},it=function(t){at&&at===t||(t&&"object"===e(t)||(t={}),t=A(t),ge=ge=-1===tt.indexOf(t.PARSER_MEDIA_TYPE)?rt:t.PARSER_MEDIA_TYPE,me="application/xhtml+xml"===ge?function(e){return e}:v,we="ALLOWED_TAGS"in t?O({},t.ALLOWED_TAGS,me):Le,Te="ALLOWED_ATTR"in t?O({},t.ALLOWED_ATTR,me):_e,qe="ADD_URI_SAFE_ATTR"in t?O(A(Xe),t.ADD_URI_SAFE_ATTR,me):Xe,Ge="ADD_DATA_URI_TAGS"in t?O(A(Ke),t.ADD_DATA_URI_TAGS,me):Ke,Ve="FORBID_CONTENTS"in t?O({},t.FORBID_CONTENTS,me):Be,Pe="FORBID_TAGS"in t?O({},t.FORBID_TAGS,me):{},Oe="FORBID_ATTR"in t?O({},t.FORBID_ATTR,me):{},He="USE_PROFILES"in t&&t.USE_PROFILES,Ae=!1!==t.ALLOW_ARIA_ATTR,je=!1!==t.ALLOW_DATA_ATTR,xe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=t.SAFE_FOR_TEMPLATES||!1,Me=t.WHOLE_DOCUMENT||!1,Ue=t.RETURN_DOM||!1,Fe=t.RETURN_DOM_FRAGMENT||!1,Ne=t.RETURN_TRUSTED_TYPE||!1,Re=t.FORCE_BODY||!1,Je=!1!==t.SANITIZE_DOM,ke=!1!==t.KEEP_CONTENT,ze=t.IN_PLACE||!1,Ee=t.ALLOWED_URI_REGEXP||Ee,Ze=t.NAMESPACE||$e,t.CUSTOM_ELEMENT_HANDLING&&nt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ie.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&nt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ie.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ie.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(je=!1),Fe&&(Ue=!0),He&&(we=O({},o(F)),Te=[],!0===He.html&&(O(we,x),O(Te,N)),!0===He.svg&&(O(we,D),O(Te,J),O(Te,z)),!0===He.svgFilters&&(O(we,M),O(Te,J),O(Te,z)),!0===He.mathMl&&(O(we,R),O(Te,k),O(Te,z))),t.ADD_TAGS&&(we===Le&&(we=A(we)),O(we,t.ADD_TAGS,me)),t.ADD_ATTR&&(Te===_e&&(Te=A(Te)),O(Te,t.ADD_ATTR,me)),t.ADD_URI_SAFE_ATTR&&O(qe,t.ADD_URI_SAFE_ATTR,me),t.FORBID_CONTENTS&&(Ve===Be&&(Ve=A(Ve)),O(Ve,t.FORBID_CONTENTS,me)),ke&&(we["#text"]=!0),Me&&O(we,["html","head","body"]),we.table&&(O(we,["tbody"]),delete Pe.tbody),u&&u(t),at=t)},st=O({},["mi","mo","mn","ms","mtext"]),ct=O({},["foreignobject","desc","title","annotation-xml"]),lt=O({},["title","style","font","a","script"]),dt=O({},D);O(dt,M),O(dt,W);var ut=O({},R);O(ut,U);var ft=function(e){var t=re(e);t&&t.tagName||(t={namespaceURI:$e,tagName:"template"});var r=v(e.tagName),a=v(t.tagName);return e.namespaceURI===Ye?t.namespaceURI===$e?"svg"===r:t.namespaceURI===Qe?"svg"===r&&("annotation-xml"===a||st[a]):Boolean(dt[r]):e.namespaceURI===Qe?t.namespaceURI===$e?"math"===r:t.namespaceURI===Ye?"math"===r&&ct[a]:Boolean(ut[r]):e.namespaceURI===$e&&!(t.namespaceURI===Ye&&!ct[a])&&!(t.namespaceURI===Qe&&!st[a])&&!ut[r]&&(lt[r]||!dt[r])},pt=function(e){C(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ne}catch(t){e.remove()}}},gt=function(e,t){try{C(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Ue||Fe)try{pt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},mt=function(e){var t,r;if(Re)e="<remove></remove>"+e;else{var a=E(e,/^[\r\n\t ]+/);r=a&&a[0]}"application/xhtml+xml"===ge&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=oe?oe.createHTML(e):e;if(Ze===$e)try{t=(new h).parseFromString(o,ge)}catch(e){}if(!t||!t.documentElement){t=se.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=et?"":o}catch(e){}}var n=t.body||t.documentElement;return e&&r&&n.insertBefore(i.createTextNode(r),n.childNodes[0]||null),Ze===$e?de.call(t,Me?"html":"body")[0]:Me?t.documentElement:n},ht=function(e){return ce.call(e.ownerDocument||e,e,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},bt=function(e){return e instanceof m&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof g)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},yt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},St=function(e,t,r){pe[e]&&y(pe[e],(function(e){e.call(a,t,r,at)}))},Ct=function(e){var t;if(St("beforeSanitizeElements",e,null),bt(e))return pt(e),!0;if(_(/[\u0080-\uFFFF]/,e.nodeName))return pt(e),!0;var r=me(e.nodeName);if(St("uponSanitizeElement",e,{tagName:r,allowedTags:we}),e.hasChildNodes()&&!yt(e.firstElementChild)&&(!yt(e.content)||!yt(e.content.firstElementChild))&&_(/<[/\w]/g,e.innerHTML)&&_(/<[/\w]/g,e.textContent))return pt(e),!0;if("select"===r&&_(/<template/i,e.innerHTML))return pt(e),!0;if(!we[r]||Pe[r]){if(!Pe[r]&&Et(r)){if(Ie.tagNameCheck instanceof RegExp&&_(Ie.tagNameCheck,r))return!1;if(Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(r))return!1}if(ke&&!Ve[r]){var o=re(e)||e.parentNode,n=te(e)||e.childNodes;if(n&&o)for(var i=n.length-1;i>=0;--i)o.insertBefore(Z(n[i],!0),ee(e))}return pt(e),!0}return e instanceof d&&!ft(e)?(pt(e),!0):"noscript"!==r&&"noembed"!==r||!_(/<\/no(script|embed)/i,e.innerHTML)?(De&&3===e.nodeType&&(t=e.textContent,t=w(t,he," "),t=w(t,be," "),e.textContent!==t&&(C(a.removed,{element:e.cloneNode()}),e.textContent=t)),St("afterSanitizeElements",e,null),!1):(pt(e),!0)},vt=function(e,t,r){if(Je&&("id"===t||"name"===t)&&(r in i||r in ot))return!1;if(je&&!Oe[t]&&_(ye,t));else if(Ae&&_(Se,t));else if(!Te[t]||Oe[t]){if(!(Et(e)&&(Ie.tagNameCheck instanceof RegExp&&_(Ie.tagNameCheck,e)||Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(e))&&(Ie.attributeNameCheck instanceof RegExp&&_(Ie.attributeNameCheck,t)||Ie.attributeNameCheck instanceof Function&&Ie.attributeNameCheck(t))||"is"===t&&Ie.allowCustomizedBuiltInElements&&(Ie.tagNameCheck instanceof RegExp&&_(Ie.tagNameCheck,r)||Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(r))))return!1}else if(qe[t]);else if(_(Ee,w(r,ve,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==L(r,"data:")||!Ge[e])if(xe&&!_(Ce,w(r,ve,"")));else if(r)return!1;return!0},Et=function(e){return e.indexOf("-")>0},wt=function(e){var t,r,o,n;St("beforeSanitizeAttributes",e,null);var i=e.attributes;if(i){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(n=i.length;n--;){var c=t=i[n],l=c.name,d=c.namespaceURI;if(r="value"===l?t.value:T(t.value),o=me(l),s.attrName=o,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,St("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(gt(l,e),s.keepAttr))if(_(/\/>/i,r))gt(l,e);else{De&&(r=w(r,he," "),r=w(r,be," "));var u=me(e.nodeName);if(vt(u,o,r))try{d?e.setAttributeNS(d,l,r):e.setAttribute(l,r),S(a.removed)}catch(e){}}}St("afterSanitizeAttributes",e,null)}},Lt=function e(t){var r,a=ht(t);for(St("beforeSanitizeShadowDOM",t,null);r=a.nextNode();)St("uponSanitizeShadowNode",r,null),Ct(r)||(r.content instanceof s&&e(r.content),wt(r));St("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(t,o){var i,c,d,u,f;if((et=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!yt(t)){if("function"!=typeof t.toString)throw I("toString is not a function");if("string"!=typeof(t=t.toString()))throw I("dirty is not a string, aborting")}if(!a.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(yt(t))return r.toStaticHTML(t.outerHTML)}return t}if(We||it(o),a.removed=[],"string"==typeof t&&(ze=!1),ze){if(t.nodeName){var p=me(t.nodeName);if(!we[p]||Pe[p])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(c=(i=mt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?i=c:i.appendChild(c);else{if(!Ue&&!De&&!Me&&-1===t.indexOf("<"))return oe&&Ne?oe.createHTML(t):t;if(!(i=mt(t)))return Ue?null:Ne?ne:""}i&&Re&&pt(i.firstChild);for(var g=ht(ze?t:i);d=g.nextNode();)3===d.nodeType&&d===u||Ct(d)||(d.content instanceof s&&Lt(d.content),wt(d),u=d);if(u=null,ze)return t;if(Ue){if(Fe)for(f=le.call(i.ownerDocument);i.firstChild;)f.appendChild(i.firstChild);else f=i;return Te.shadowroot&&(f=ue.call(n,f,!0)),f}var m=Me?i.outerHTML:i.innerHTML;return Me&&we["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&_(Q,i.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+m),De&&(m=w(m,he," "),m=w(m,be," ")),oe&&Ne?oe.createHTML(m):m},a.setConfig=function(e){it(e),We=!0},a.clearConfig=function(){at=null,We=!1},a.isValidAttribute=function(e,t,r){at||it({});var a=me(e),o=me(t);return vt(a,o,r)},a.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],C(pe[e],t))},a.removeHook=function(e){if(pe[e])return S(pe[e])},a.removeHooks=function(e){pe[e]&&(pe[e]=[])},a.removeAllHooks=function(){pe={}},a}()}()},66:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,a){return t.traceTag(0,e,r,a)},traceTag:function(e,r,a,o){return t.traceTag(e,r,a,o)},debugTrace:function(e,r,a){return t.debugTraceTag(0,e,r,a)},debugTraceTag:function(e,r,a,o){return t.debugTraceTag(e,r,a,o)},assert:function(e,r,a){return t.assertTag(0,e,r,a)},assertTag:function(e,r,a,o){return t.assertTag(e,r,a,o)},shipAssert:function(e,r,a){return t.shipAssertTag(0,e,r,a)},shipAssertTag:function(e,r,a,o){return t.shipAssertTag(e,r,a,o)},dnmTrace:function(e,r,a){return t.dnmTraceTag(0,e,r,a)},dnmTraceTag:function(e,r,a,o){return t.dnmTraceTag(e,r,a,o)}}}}};var a=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)},e.prototype.assertTag=function(e,t,r,a){console.assert(r,"assertTag",e,t,a)},e.prototype.traceTag=function(e,t,r,a){console.log("traceTag",e,a,t,r)},e.prototype.dnmTraceTag=function(e,t,r,a){console.log("dnmTraceTag",e,a,t,r)},e.prototype.debugTraceTag=function(e,t,r,a){console.log("debugTraceTag",e,a,t,r)},e}();t.ConsoleLogger=a;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=o},797:function(e,t,r){"use strict";r.r(t);var a,o=r(3),n=r(2);function i(e){Object(o.fc)().ULS.shipAssertTag(595944468,n.LogCategory.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),a=e}var s,c=r(1);var l,d={serializeMetadata:function(e){if(!e)return"{}";try{var t={},r=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:s.serializeSourceItem(e.sourceItem),commandParameters:s.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed}}catch(e){return void Object(o.fc)().ULS.traceTag(595945243,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: ".concat(n.utils.getStringifiedError(e)))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return Object(o.fc)().ULS.traceTag(595945242,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: ".concat(n.utils.getStringifiedError(e))),"{}"}},deserializeMetadata:function(e){if(!e)return Object(o.rb)();try{var t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");var t=new o.l;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=s.deserializeSourceItem(e.sourceItem),t.commandParameters=s.deserializeCommandParameters(e.commandParameters),t}catch(e){return void Object(o.fc)().ULS.traceTag(595945245,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ".concat(n.utils.getStringifiedError(e),"."))}}(t.copyContext)),r}catch(e){Object(o.fc)().ULS.traceTag(595945244,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: ".concat(n.utils.getStringifiedError(e)))}return Object(o.rb)()}};function u(e,t,r){return Object(o.fc)().ULS.shipAssertTag(595945246,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),Object(o.fc)().ULS.shipAssertTag(595945247,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),l=e,f=function(e){return s=e,d}(t),(p=r)&&p.setOnMetadataChangedListener(y),b}var f,p,g,m=Object(o.rb)(),h={},b={getCachedMetadata:function(){return Object(o.fc)().ULS.traceTag(595730648,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: ".concat(E(m))),Object(o.Q)(m)},updateMetadata:function(e){Object(o.fc)().ULS.traceTag(595730652,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: start update metadata with metadata : ".concat(E(e)));var t=Object(c.__assign)(Object(c.__assign)({},m),e),r=Object(o.R)();r.setItem("metadata",f.serializeMetadata(t)),Object(o.fc)().ULS.traceTag(595730653,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: schedule metadata with value: ".concat(E(t))),C(r,t)},clear:function(){Object(o.fc)().ULS.traceTag(595730654,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.clear: start clear metadata");var e=Object(o.rb)();C(Object(o.R)(),e)},addMetadataChangeListener:function(e,t){e||Object(o.fc)().ULS.traceTag(595936158,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");t||Object(o.fc)().ULS.traceTag(595936159,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define");h[e]&&Object(o.fc)().ULS.traceTag(595936160,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: listener with same listenerId(".concat(e," already exist."));h[e]=t},removeMetadataChangeListener:function(e){e||Object(o.fc)().ULS.traceTag(595936161,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");h[e]?delete h[e]:Object(o.fc)().ULS.traceTag(595936162,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ".concat(e,"."))},getMetadataSyncPromise:function(){if(!g||!Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete"))return Object(o.fc)().ULS.traceTag(595937173,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Object(o.Q)(m));return Object(o.fc)().ULS.traceTag(595937174,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),g.deferredPromise.promise.then((function(e){return Object(o.fc)().ULS.traceTag(595937175,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e}))},isMetadataSync:function(){return!g}};function y(e){try{if(e&&0!==Object(o.nb)(e)){var t=e.getItem("metadata");m=f.deserializeMetadata(t),Object(o.fc)().ULS.traceTag(595730650,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set cached metadata with value ".concat(E(m)))}else Object(o.fc)().ULS.traceTag(595730649,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),m=Object(o.rb)()}catch(e){Object(o.fc)().ULS.traceTag(595945248,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: ".concat(n.utils.getStringifiedError(e))),m=Object(o.rb)()}S(Object(o.Q)(m))}function S(e){for(var t in Object(o.fc)().ULS.traceTag(595730651,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : ".concat(E(e))),h){var r=h[t];r&&r(e)}}function C(e,t){var r=Object(o.bb)();g?g.metadataSyncMessageId=r:(g={metadataSyncMessageId:r,deferredPromise:Object(o.V)()},Object(o.fc)().ULS.traceTag(595937176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. ".concat(g.metadataSyncMessageId))),Object(o.fc)().ULS.traceTag(595937177,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ".concat(r,".")),setTimeout((function(){l.set(e,{}).then((function(){m=t,Object(o.fc)().ULS.traceTag(595937178,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=".concat(r,". _syncMetadata.metadataSyncMessageId = ").concat(g&&g.metadataSyncMessageId,". newMetadata = ").concat(E(t))),v(r)}),(function(e){Object(o.fc)().ULS.traceTag(595945250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: ".concat(n.utils.getStringifiedError(e))),v(r)}))}),0)}function v(e){if(Object(o.fc)().ULS.traceTag(595730655,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: ".concat(e)),g&&g.metadataSyncMessageId===e){var t=g;g=void 0;var r=Object(o.Q)(m);Object(o.fc)().ULS.traceTag(595730656,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: ".concat(E(r))),S(r),t.deferredPromise.resolve(r)}}function E(e){return e?e.lastCopy?"copyContext.id=".concat(e.lastCopy.id):"copy context is null":"metadata is null"}var w=function(){function e(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=n.utils.calcHashCode(e):(this.userHash=1565411791,Object(o.fc)().ULS.traceTag(595903939,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"userId not exist!. Use default ID"))}return e.prototype.wrapTextWithDataSignature=function(e,t,r,a,n){void 0===a&&(a="null");var i,s={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:a};return(i=null!==n&&0!==Object.keys(n).length?Object(c.__assign)(Object(c.__assign)({},s),n):s)[o.Bb.ccpTimestampHtmlCustomAttributeName]=r,o.Bb.wrapContentWithTagAndAttributes(e,t,i)},e.prototype.ensureDataSignatureInHtmlItem=function(e){if(0!==Object(o.nb)(e)){var t=Object(o.tb)(e),r=Object(o.lb)(t,o.ec),a=Object(o.lb)(t,o.Qb),n=Object(o.lb)(t,o.Ob),i=null;if(n!==o.jb&&(i=JSON.parse(n)),r){if(void 0!==this.getRegExIntValue(r,"ccp_infra_version=['|\"](\\d+)['|\"]"))return;e.setItem(o.ec,this.wrapTextWithDataSignature(r,o.Bb.divTagName,Date.now(),a,i))}else{var s=Object(o.pb)(t),c=o.Bb.createTextHtmlFromTextPlain(s),l=this.wrapTextWithDataSignature(c,o.Bb.preTagName,Date.now(),a,i);e.setItem(o.ec,o.Bb.addClipboardWrapperForEdge(l))}}},e.prototype.extractSignatureData=function(e){if(Object(o.ob)(e)>0){var t=Object(o.mb)(e,o.ec),r=this.getRegExIntValue(t,"ccp_infra_version=['|\"](\\d+)['|\"]");if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw Object(o.fc)().ULS.traceTag(595902983,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ".concat(r,", CCPInfraVersion = ").concat(3)),new o.A("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(Object(o.fc)().ULS.traceTag(595902986,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". Converting to the data")),this.parseOldSignatureData(t)):(r>3&&Object(o.fc)().ULS.traceTag(595900176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". ( It's OK - Should be forward compatibility)")),this.parseCurrentVersionSignatureData(t))}},e.prototype.parseCurrentVersionSignatureData=function(e){var t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){var a=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return a&&Object(o.fc)().ULS.traceTag(595183181,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : ".concat(a)),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:a||""}}Object(o.fc)().ULS.traceTag(595902985,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: ".concat(e))},e.prototype.parseOldSignatureData=function(e){return this.parseCurrentVersionSignatureData(e)},e.prototype.parsePreSignatureData=function(e){var t=o.Bb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(e);if(Object(o.fc)().ULS.traceTag(595723668,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp=".concat(t)),t){if(this.blockMismatchDataVersion)throw Object(o.fc)().ULS.traceTag(595899270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new o.A("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);var r={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return Object(o.fc)().ULS.traceTag(595723669,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData"),r}},e.prototype.validateTTL=function(e){if(e&&this.ttlInMs){var t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw Object(o.fc)().ULS.traceTag(595899858,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Time elapsed (".concat(t," ms) from setting Clipboard (").concat(e.ccp_infra_timestamp,") is greater then TTL (").concat(this.ttlInMs," ms) - return error")),new o.K("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}},e.prototype.validateUserHash=function(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw Object(o.fc)().ULS.traceTag(595723670,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new o.N("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)},e.prototype.setMetaDataVersionItem=function(e){if(0!==Object(o.nb)(e)){var t={ccp_infra_version:3};e.setItem(o.Rb,JSON.stringify(t))}},e.prototype.validateMetaDataVersionItem=function(e){if(e&&Object(o.nb)(e)>0){var t=Object(o.mb)(e.getData(),o.Rb),r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw Object(o.fc)().ULS.traceTag(595899272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = ".concat(e)),new o.L("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = ".concat(t))}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw Object(o.fc)().ULS.traceTag(595899203,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ".concat(r.ccp_infra_version,", CCPInfraVersion = ").concat(3)),new o.A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}},e.prototype.createClipboardDataProcessor=function(e){var t=this;Object(o.fc)().ULS.traceTag(595723671,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash=".concat(e));return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(r){if(Object(o.fc)().ULS.traceTag(595723672,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash=".concat(e)),r){var a=t.extractSignatureData(r.getData());Object(o.fc)().ULS.traceTag(595723673,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash=".concat(e)),a&&r.setItem(o.Qb,a.ccp_infra_copy_id),t.validateTTL(a),e&&(Object(o.fc)().ULS.traceTag(595723674,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash=".concat(e)),t.validateUserHash(a))}}.bind(this)}},e.prototype.createDualClipboardDataProcessor=function(e){var t=this;Object(o.fc)().ULS.traceTag(595723675,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called.");return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(e){Object(o.fc)().ULS.traceTag(595723676,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=t.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[o.Qb]=e.signatureData.ccp_infra_copy_id),t.validateTTL(e.signatureData))}.bind(this),validateUserHash:e?this.validateUserHash.bind(this):function(){}}},e.prototype.createClipboardMetaDataProcessor=function(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}},e.prototype.getRegExStringValue=function(e,t){var r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]},e.prototype.getRegExIntValue=function(e,t){var r=this.getRegExStringValue(e,t);if(r){var a=Number(r);return isNaN(a)?void 0:a}},e}();var L=function(e){function t(t,r,a){var o=e.call(this,t,r,a,"WindowRPCClientInternal")||this;return o.pushMessageListeners={},o}return Object(c.__extends)(t,e),t.prototype.init=function(e){return this.deferredResultMessagePromiseCache=Object(o.W)(),this.sender=Object(o.eb)(this.serializer,this),this.receiver=Object(o.db)(this.deserializer,this,this),this.postInitMessage(e).catch((function(e){return Object(o.fc)().ULS.traceTag(596129250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"Init failure or timeout. Error: ".concat(n.utils.getStringifiedError(e))),Object(o.Gb)(e,o.f.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new o.e(o.f.IframeInitialization,"failed to init the Shared Clipboard",e))}))},t.prototype.registerPushMessageListener=function(e,t){this.pushMessageListeners[e]=t},t.prototype.postInitMessage=function(e){var t=Object(o.S)(o.Fb,"init",o.z.initIframe);if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.fc)().ULS.shipAssertTag(596121487,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout((function(){if(i&&!i.fulfilled()){var e=Date.now(),t="initialization started on ".concat(new Date(s)," and timed out on ").concat(new Date(e)," after ").concat(e-s," ms");Object(o.fc)().ULS.traceTag(596129251,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,t),i.reject(new o.e(o.f.IframeInitializationTimeout,t))}}),e),a},t.prototype.postMessage=function(t){try{if(!t)throw new o.B(o.jb,"outgoingMessage");if(Object(o.fc)().ULS.shipAssertTag(596452175,n.LogCategory.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(o.fc)().ULS.shipAssertTag(596121488,n.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.u(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new o.u("Unable to post message for operation '".concat(t?t.operationCode:void 0,"'"),e))}},t.prototype.handleMessage=function(e){Object(o.fc)().ULS.traceTag(596452376,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"RPC Client - handleMessage: incomingMessage.id='".concat(e&&e.id,"'; incomingMessage.operationCode='").concat(e&&e.operationCode,"'; incomingMessage.failed='").concat(e&&e.failed,"'; incomingMessage.error='").concat(e&&e.error,"'; incomingMessage.clipboardItems.length=").concat(Object(o.ob)(e&&e.clipboardItemsData)));var t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){var r="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.fc)().ULS.shipAssertTag(596121489,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a="initresult"===e.operationCode?o.Fb:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return i?(this.deferredResultMessagePromiseCache.delete(a),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(Object(o.fc)().ULS.traceTag(596452377,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,a===e.id?"RPC Client - handleMessage: no deferred promise with id '".concat(e.id,"'; dropping this result."):"RPC Client - handleMessage: no deferred promise with id '".concat(a,"' for message id '").concat(e.id,"'; dropping this result.")),Promise.resolve())},t.prototype.handleDeserializationError=function(e){return!e||"NoValidKeyError"!==e.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(Object(o.fc)().ULS.traceTag(596452379,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"RPC Client - handleDeserializationError. There are ".concat(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0," deferred promise(s) in the cache. Error: ").concat(n.utils.getStringifiedError(e))),Promise.resolve()):(Object(o.fc)().ULS.traceTag(542687372,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"RPC Client - handleDeserializationError. Error: ".concat(n.utils.getStringifiedError(e))),Promise.resolve())},t.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.bc)([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},t}(o.O),T=[],_={initialized:!1,origin:o.jb,src:o.jb,deferredPromise:void 0},I=void 0;function P(){return _}function O(){var e=document.createElement("iframe");return e.style.display="none",e.id="clipboard",Object(o.fc)().ULS.shipAssertTag(595952726,n.LogCategory.msoulscat_ES_EWAJS,!I,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),j(),I=Object(o.P)(e,"load",(function(e){return function(e){Object(o.fc)().ULS.traceTag(595952727,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: Entering"),j();var t=P().deferredPromise;if(!t)return void Object(o.fc)().ULS.shipAssertTag(595952728,n.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");var r=t.id;try{P().deferredPromise=void 0;var a=e.target;if(!a){var i="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '".concat(r,"'");return Object(o.fc)().ULS.shipAssertTag(595952729,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}if(!a.contentWindow){i="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '".concat(r,"'");return Object(o.fc)().ULS.shipAssertTag(595952730,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}Object(o.fc)().ULS.traceTag(595952732,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: resolving deferred promise id '".concat(r,"' with the iframe")),t.resolve(a)}catch(e){i="iframeOnLoad: an error has occurred: [".concat(n.utils.getStringifiedError(e),"]. Rejecting deferred promise id '").concat(r,"'");Object(o.fc)().ULS.traceTag(595952733,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),t.reject(new o.u(i,e))}}(e)})),e.src=P().src,e}function A(e){var t=P().origin,r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+="clipboard/shared.aspx",e&&(r+="?".concat(encodeURIComponent(o.Yb),"=").concat(encodeURIComponent(e)));var i=[];T.forEach((function(e){Object(n.ewaUtils)().isChangeGateEnabled(e)||i.push({key:e,value:"1"})}));var s=function(){if(!a)throw new o.u("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return a}();s&&s.sessionId&&i.push({key:o.Zb,value:s.sessionId});var c=Object(n.getNewGuid)(),l=c[0],d=c[1];return Object(o.fc)().ULS.traceTag(595722560,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ".concat(l," newGuidLogging: ").concat(d)),i.push({key:"corrid",value:l}),i.push({key:"NoAuth",value:"true"}),i.length>0&&i.forEach((function(e){r+=function(e){if(e.indexOf("?")>=0)return"&";return"?"}(r),r+="".concat(encodeURIComponent(e.key),"=").concat(encodeURIComponent(e.value))})),r}function j(){if(I){try{I()}catch(e){}I=void 0}}var x=void 0;function D(){if(!x)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!P().initialized)throw new o.u("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(o.fc)().ULS.traceTag(595952723,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found ".concat(e.length," iframes"));for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&"clipboard"===r.id)return r}Object(o.fc)().ULS.traceTag(595952724,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(o.fc)().ULS.traceTag(595952722,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(o.fc)().ULS.traceTag(596448770,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ".concat(void 0!==e.src&&void 0!==x.src&&e.src.toLowerCase()===x.src.toLowerCase()?"===":"!=="," src; deferredPromise ").concat(void 0===x.deferredPromise?"does not exist":"exists","; The iframe's content window ").concat(void 0===e.contentWindow?"does not exist":"exists",".")),function(e){if(!e)throw new o.B(o.jb,"iframe");Object(o.fc)().ULS.traceTag(595952725,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),j(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=x.deferredPromise,r=t?t.id:o.jb;if(t){j(),x.deferredPromise=void 0;var a="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '".concat(r,"' and creating a new one");Object(o.fc)().ULS.shipAssertTag(596453587,n.LogCategory.msoulscat_ES_EWAJS,!1,a),t.reject(new o.u(a)),t=void 0}x.deferredPromise=Object(o.V)(Object(o.bb)()),r=(t=x.deferredPromise).id;try{e=O(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){a="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '".concat(r,"'");return Object(o.fc)().ULS.traceTag(596453588,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,a),x.deferredPromise=void 0,j(),Promise.reject(new o.u(a,e))}return t&&!t.fulfilled()?t.promise:(j(),e.contentWindow?(x.deferredPromise=void 0,Promise.resolve(e)):(Object(o.fc)().ULS.shipAssertTag(596453589,n.LogCategory.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")),Promise.reject(new o.u("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")))))}var M,W;function R(){if(W)return W.promise;W=Object(o.V)(Object(o.bb)());try{var e=function(e){return x||(x=P()),x.initialized||(x.origin=Object(o.xb)(e),x.src=A(e),x.initialized=!0),x.origin}(Object(o.zb)().origin);M=function(e,t){return new L(Object(o.cb)(o.hc),Object(o.ab)(o.ic),{window:t,windowOrigin:e})}(e,void 0),n.utils.retry((function(e,t){return function(e,t){if(!M){var r="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return Object(o.fc)().ULS.shipAssertTag(595947544,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=n.perfWatch.start("Iframe_initialize_".concat(e));n.perfWatch.mark(a,"start"),M.remoteWindow.window=void 0;var i=function(r){var i=Object(o.Gb)(r,o.f.IframeInitializationTimeout)?" due to a timeout of approx. ".concat(t," ms"):o.jb;n.perfWatch.mark(a,"finish_error"),n.perfWatch.failure(a,(function(e){return Object(o.fc)().ULS.traceTag(596452419,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)}),"Attempt #".concat(e," failed to initialize an iframe ").concat(i,". ").concat(e<3?"Retrying...":"No more retries!",". Error: ").concat(n.utils.getStringifiedError(r)))},s=Object(o.V)();return D().then((function(r){if(n.perfWatch.mark(a,"iframe_loaded"),n.perfWatch.mark(a,"iframe_waiting_for_idb_init"),!M){var s="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";Object(o.fc)().ULS.shipAssertTag(595947545,n.LogCategory.msoulscat_ES_EWAJS,!1,s);var c=new o.u(s);return i(c),Promise.reject(c)}if(!r.contentWindow){s="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";Object(o.fc)().ULS.shipAssertTag(595903557,n.LogCategory.msoulscat_ES_EWAJS,!1,s);c=new o.u(s);return i(c),Promise.reject(c)}return M.remoteWindow.window=r.contentWindow,M.init(t).then((function(){return n.perfWatch.mark(a,"iframe_idb_init_complete"),n.perfWatch.mark(a,"finish"),n.perfWatch.success(a,(function(e){return Object(o.fc)().ULS.traceTag(596452418,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)}),"Attempt #".concat(e," initialized iframe")),Promise.resolve()}))})).then((function(){s.resolve()}),(function(e){i(e),s.reject(e)})),s.promise}(e,2e4+(Object(o.Gb)(t,o.f.IframeInitializationTimeout)?5e3:0)*(e-1))}),3).then((function(){W.resolve(M)}),(function(e){W.reject(e)}))}catch(e){W.reject(e)}return W.promise}var U=function(){function e(){this.initialized=!1}return e.prototype.innerInitialize=function(){var e=this;return R().then((function(t){return e.initialized=!0,e.windowRPCClient=t,e}))},e.prototype.registerPushMessageListener=function(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)},e.prototype.postMessage=function(e,t){if(!this.initialized)return Promise.reject(new o.e(o.f.IframeInitialization));var r=n.perfWatch.start("BaseIframeProxy_".concat(t));n.perfWatch.mark(r,"start");var a=function(e){return n.perfWatch.mark(r,"finish_error"),n.perfWatch.failure(r,(function(e){return Object(o.fc)().ULS.traceTag(596452188,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)}),"Failed in BaseIframeProxy.postMessage. Error: ".concat(n.utils.getStringifiedError(e))),Promise.reject(new o.e(o.f.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e))};if(!this.windowRPCClient){var i="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return Object(o.fc)().ULS.shipAssertTag(595944461,n.LogCategory.msoulscat_ES_EWAJS,!1,i),a(new o.u(i))}return this.windowRPCClient.postMessage(e).then((function(e){return Object(o.fc)().ULS.shipAssertTag(595944462,n.LogCategory.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new o.e(o.f.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: ".concat(e.error))):(n.perfWatch.mark(r,"finish"),n.perfWatch.success(r,(function(e){return Object(o.fc)().ULS.traceTag(596452187,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),Promise.resolve(e)):Promise.reject(new o.e(o.f.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))})).catch((function(e){return a(e)}))},e}(),F=function(){function e(e){this.localStorageKey=e}return e.prototype.initialize=function(e){var t=this;return new o.y(this.localStorageKey,e,(function(e){t._onMetadataChangedListener&&t._onMetadataChangedListener(e)})),Promise.resolve()},e.prototype.setOnMetadataChangedListener=function(e){Object(o.fc)().ULS.traceTag(595716297,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.fc)().ULS.shipAssertTag(595716298,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},e}(),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.initialize=function(t){var r=this;return e.prototype.innerInitialize.call(this).then((function(){r.registerPushMessageListener("getMetadata_longPollingresult",(function(e){r._onMetadataChangedListener&&r._onMetadataChangedListener(Object(o.R)(e))}))}))},t.prototype.setOnMetadataChangedListener=function(e){Object(o.fc)().ULS.traceTag(595730647,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.fc)().ULS.shipAssertTag(595944466,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},t}(U),J=function(e){function t(t){return e.call(this,o.i.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),k=!0;function z(){return k}function H(){k=!1}var V=!0;function B(){return V}function G(){V=!1}function K(){var e=void 0;try{e=window.clipboardData}catch(e){Object(o.fc)().ULS.traceTag(595985225,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: ".concat(n.utils.getStringifiedError(e)))}return e}function q(){if(Object(o.fc)().ULS.shipAssertTag(596455701,n.LogCategory.msoulscat_ES_EWAJS,Object(o.Lb)(),"The browser must be IE"),!Object(o.Lb)())throw new o.u("The browser must be IE")}function X(e){return!!(e&&e.setData&&e.getData)}function Q(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw Object(o.fc)().ULS.traceTag(595985224,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: ".concat(n.utils.getStringifiedError(e))),e}return t}Object(o.fc)().ULS.traceTag(596456320,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"A clipboard event parameter is missing")}function Y(e,t,r,a){var i=!1;try{var s=Q(r);if(!s||!X(s))return Object(o.fc)().ULS.traceTag(596456264,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - programmatic ".concat(o.j," and ").concat(o.p," is broken. There is no valid data transfer object. clipboardDataFormat = '").concat(e,"'")),!1;!1===(i=s.setData(e,t))&&Object(o.fc)().ULS.traceTag(596456265,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '".concat(e,"'."))}catch(t){Object(o.fc)().ULS.traceTag(596456266,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '".concat(e,"' threw an exception: ").concat(n.utils.getStringifiedError(t)))}return void 0===i&&(i=!0),i}function $(e,t,r,a){if(q(),!a&&!z()&&!B())return Object(o.fc)().ULS.traceTag(596456269,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData - programmatic ".concat(o.j," and ").concat(o.p," clipboard access is not supported. rawEvent is empty = ").concat(!!r)),!1;var i=K();if(!i||!X(i))return Object(o.fc)().ULS.traceTag(596456270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - ".concat(o.j," and ").concat(o.p," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),a||(Object(o.fc)().ULS.shipAssertTag(596456271,n.LogCategory.msoulscat_ES_EWAJS,z()&&B(),"setData - programmatic ".concat(o.j," and ").concat(o.p," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(z(),"'. isProgrammaticAccessSupported = '").concat(B(),"'. clipboardDataFormat = '").concat(e,"'")),H(),G()),!1;var s,c=e;c===o.hb&&(c=o.ib);try{!1===(s=i.setData(c,t))&&Object(o.fc)().ULS.traceTag(596456272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '".concat(c,"'."))}catch(e){Object(o.fc)().ULS.traceTag(596456273,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '".concat(c,"' threw an exception: ").concat(e.message))}return!a&&z()&&(H(),!1===s&&G()),void 0===s&&(s=!0),s}function Z(){return z()&&$(o.hb,o.jb,void 0,!1),!!B()||(Object(o.fc)().ULS.traceTag(596456274,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard access is not allowed for '".concat(o.j,"' and '").concat(o.p,"'.")),!1)}var ee={execCommandCopy:function(){var e;try{e=document.execCommand(o.j,!1,null)}catch(e){Object(o.fc)().ULS.traceTag(596456262,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.j,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(o.p,!1,null)}catch(e){Object(o.fc)().ULS.traceTag(596456263,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.p,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},setData:Y,defaultClipboardDataFormat:o.hb},te={execCommandCopy:function(){if(q(),!Z())return!1;try{document.execCommand(o.j,!1,null)}catch(e){Object(o.fc)().ULS.traceTag(596456267,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.j,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},execCommandCut:function(){if(q(),!Z())return!1;try{document.execCommand(o.p,!1,null)}catch(e){Object(o.fc)().ULS.traceTag(596456268,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.p,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},setData:$,defaultClipboardDataFormat:o.ib},re=void 0;function ae(e,t,r,a){return oe().setData(e,t,r,a)}function oe(){return void 0===re&&(re=ee),re}Object(o.Lb)()&&(re=te);var ne=void 0,ie={};function se(){if(void 0===ne&&(ne=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?ne=!0:Object(o.fc)().ULS.traceTag(596455703,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(o.fc)().ULS.traceTag(596455704,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chrome.runtime is not available"))}return ne}function ce(){if(!se())return Promise.reject(new o.e(o.f.MissingBrowserExtensionCapability));var e=function(){for(var e in ie){if(ie[e].includes("getClipboardData"))return e}return null}();if(!e)return Promise.reject(new o.e(o.f.NoBrowserExtensionWithGetClipboardDataCommand));var t={command:"getClipboardData"};return function(e,t){return new Promise((function(r,a){var i=!0;window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var n=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||n){i=!1;var s=o.jb;n&&"message"in n&&"string"==typeof n.message&&(s=n.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat("getClipboardData","': browser extension '").concat(e,"' is not available. Error: ").concat(s)))}else{i=!1;var c=t,l=c.html,d=c.img,u=c.text,f=function(e,t,r){var a=!!e,o=!!t,n=!!r,i=e.includes("<img src="),s=o&&a&&i;return o&&!n||s}(l,d,u);r({text:u,html:f?d:l})}})),setTimeout((function(){i&&(Object(o.fc)().ULS.traceTag(589947076,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '".concat(ie,"'")),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat("getClipboardData","': browser extension '").concat(e,"' is not available. Timeout after : ").concat(2e3," ms"))))}),2e3)}))}(e,t).then((function(t){if(!t)return Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions));Object(o.fc)().ULS.traceTag(589947075,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - paste by browser extension '".concat(e,"'"));var r=Object(o.R)();return r.setItem(o.hb,t.text),r.setItem(o.ec,t.html),r.setItem(o.Pb,e),r}))}function le(e){if(!e||!e.items)return Promise.reject(new o.H(o.I.ClipboardIsInaccessible,"getImageDataUrlFromClipboardData: clipboardData is undefined=".concat(!e," clipboardData.items is undefined=").concat(!e.items)));for(var t=function(t){var r=Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:5868076_BlockNonImageFilePaste"),a=!r||e.items[t].type&&e.items[t].type.startsWith("image");if(r&&!a&&Object(o.fc)().ULS.traceTag(528859143,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Non-image type read from System Clipboard. File Type is "+e.items[t].type),"file"===e.items[t].kind&&a){var i=n.perfWatch.start("ImageFile_Read_From_Clipboard"),s=e.items[t].getAsFile(),c=s?s.size:-1,l=Object(o.V)(),d=new FileReader;return d.onload=function(){d.result?(n.perfWatch.success(i,(function(e){return Object(o.fc)().ULS.traceTag(595911452,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,de(e,c))})),l.resolve(d.result.toString())):(n.perfWatch.failure(i,(function(e){return Object(o.fc)().ULS.traceTag(595911453,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,de(e,c))})),l.reject(new o.H(o.I.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},d.onerror=function(){n.perfWatch.failure(i,(function(e){return Object(o.fc)().ULS.traceTag(595911454,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,de(e,c))})),l.reject(new o.H(o.I.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},n.perfWatch.mark(i,"Starting_readAsDataURL"),d.readAsDataURL(s),{value:l.promise}}},r=0;r<e.items.length;r+=1){var a=t(r);if("object"==typeof a)return a.value}return Promise.resolve(o.jb)}function de(e,t){var r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function ue(e,t,r){if(q(),!r&&!z()&&!B())return Object(o.fc)().ULS.traceTag(596456327,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData - programmatic ".concat(o.E," clipboard access is not supported. rawEvent is empty = ").concat(!!t)),Promise.resolve(o.jb);var a=K();if(!a||!X(a))return Object(o.fc)().ULS.traceTag(596456328,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData - ".concat(o.E," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),r||(Object(o.fc)().ULS.shipAssertTag(596456329,n.LogCategory.msoulscat_ES_EWAJS,z()&&B(),"getData - programmatic ".concat(o.E," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(z(),"'. isProgrammaticAccessSupported = '").concat(B(),"'. clipboardDataFormat = '").concat(e,"'")),H(),G()),Promise.resolve(o.jb);var i=e;i===o.hb&&(i=o.ib);var s=o.jb;try{(s=a.getData(i))||(s=o.jb),Object(o.fc)().ULS.traceTag(596456330,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('".concat(i,"') returned ").concat(s.length," characters"))}catch(e){Object(o.fc)().ULS.traceTag(596456331,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData with '".concat(i,"' threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}if(!r&&z()&&(H(),s===o.jb)){if(Y(e,o.Xb,void 0))return ue(e,void 0,!1).then((function(t){return t===o.jb?G():Y(e,o.jb,void 0),Promise.resolve(s)}));G()}return Promise.resolve(s)}var fe={init:function(){},execCommandPaste:function(){var e;try{e=document.execCommand(o.E,!1,null)}catch(e){Object(o.fc)().ULS.traceTag(596456322,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},getData:function(e,t,r){var a=o.jb;try{var i=Q(t);if(!i||!X(i))return Promise.resolve(a);if(e===o.Cb)return le(i);(a=i.getData(e))||(a=o.jb),Object(o.fc)().ULS.traceTag(596456323,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){Object(o.fc)().ULS.traceTag(596456324,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(n.utils.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},pe={init:function(){},execCommandPaste:function(){if(q(),z()&&ue(o.hb,void 0,!1),!B())return Object(o.fc)().ULS.traceTag(596456325,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard '".concat(o.E,"' access is not allowed in this session.")),!1;try{document.execCommand(o.E,!1,null)}catch(e){Object(o.fc)().ULS.traceTag(596456326,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},getData:ue,browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},ge={init:function(){!function(){var e=Ue().getChromeExtensionIds();if(0!==e.length){var t={command:"getAvailableCommands"};e.forEach((function(e){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)ie[e]=t;else{var a=o.jb;r&&"message"in r&&"string"==typeof r.message&&(a=r.message),Object(o.fc)().ULS.traceTag(589947074,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - '".concat("getAvailableCommands","': browser extension '").concat(e,"' is not available. Error: ").concat(a))}}))}))}}()},execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(o.E,!1,null))&&(e=!0)}catch(e){Object(o.fc)().ULS.traceTag(596455698,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('".concat(o.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return e},getData:function(e,t,r){var a=o.jb;try{var i=Q(t);if(!i||!X(i))return Promise.resolve(a);if(e===o.Cb)return le(i);(a=i.getData(e))||(a=o.jb),Object(o.fc)().ULS.traceTag(596455699,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){Object(o.fc)().ULS.traceTag(596455700,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(n.utils.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return ce()}},me=void 0;function he(){return void 0===me&&(me=se()?ge:fe),me}Object(o.Lb)()&&(me=pe);var be=r(404);function ye(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function Se(e,t,r){void 0===r&&(r=void 0),Object(o.fc)().ULS.shipAssertTag(596444114,n.LogCategory.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===o.jb),"enableClipboardEvents: useTextHtmlContentCandidate = '".concat(t,"', textHtmlContentCandidate is ").concat(r||r===o.jb?o.jb:"not ","provided"));var a=document.activeElement&&document.activeElement.id;a||Object(o.fc)().ULS.traceTag(595719625,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");var i=function(e,t){var r=Ee();r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0);r||(r=function(){var e=document.createElement("div");return function(e){e.id="ccpContentEditable",e.contentEditable="true",Te()&&(e.contentEditable="false");e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,Object(o.fc)().ULS.assertTag(595957699,n.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element '".concat("ccpContentEditable","'. it should be covered by other elements"))}}(e),document.body.appendChild(e),e}());if(Object(o.Lb)()){var a=t;e?a||(a=o.jb):a=Le().outerHTML,r.innerHTML=be.sanitize(a)}else{a=t;e?(a||(a=o.jb),_e(r,a)):_e(r,Le())}return r}(t,r);a&&a===i.id&&(a=void 0),i.focus();var s=document.getSelection();if(s){s.removeAllRanges();var c=document.createRange();c.selectNodeContents(i),s.addRange(c)}return e&&Ce(!0),a}function Ce(e){if(Te()){var t=Ee();t&&(t.contentEditable=e?"true":"false")}}function ve(){var e=Ee();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return Object(o.fc)().ULS.traceTag(595957534,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: ".concat(n.utils.getStringifiedError(e))),!1}}function Ee(){return document.getElementById("ccpContentEditable")}function we(){var e=Ee();e&&(Object(o.Lb)()?e.innerHTML=be.sanitize(Le().outerHTML):_e(e,Le()))}function Le(){var e=document.createElement("span");return e.innerText=o.Wb,e}function Te(){return!Object(o.Lb)()}function _e(e,t){try{e.append(t)}catch(a){if(!(a instanceof TypeError))throw a;if("string"==typeof t){var r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)}}var Ie=function(){function e(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.clipboardFormatReadTimes={},this.clipboardFormatReadStatus={},this.asyncApiReadTimedOut=!1,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=o.g.SystemClipboard,this.disposableImplementationExtension=Object(o.X)("SystemClipboardStorage"),he().init()}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.fc)().ULS.traceTag(596449096,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: isKeyboardEvent = '".concat(e.isKeyboardEvent,"'")),e.skipSystemClipboardAccess){Object(o.fc)().ULS.traceTag(596124883,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=Object(o.P)(document,o.F,(function(e){return t.skipSystemClipboardPasteHandler(e,r)}),!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(Object(o.sb)())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var a=this.lastDeferredPastePromise,i="There exists a pending deferred promise with id '".concat(a.id,"', representing an active ").concat(o.E," event. Scheduling a rejection to execute after the current operation.");Object(o.fc)().ULS.traceTag(596455680,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),window.setTimeout((function(){a.reject(new o.e(o.f.RejectingPendingPastePromiseDueToNewPasteOperation,i))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=Object(o.V)();this.lastDeferredPastePromise=s;var c=s.id,l=Object(o.P)(document,o.F,(function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,l,e)}),!0);this.removeLastPasteEventListenerCallback=l,this.selectedRangeToRestore=ye(),this.activeElementIdToRestore=Se(!0,!1);try{var d=!1;if(e.isKeyboardEvent||(d=he().execCommandPaste()),e.isKeyboardEvent);else if(!d)return this.clearPasteCallbackConfiguration(s,!0,!0),he().browserExtensionPaste().then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"document.execCommand(".concat(o.E,") failed in SystemClipboard.get. Deferred promise id = '").concat(c,"'"),r))}))}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(c,"'"),e))}return s.promise.then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Object(o.Gb)(r,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(c,"'"),r))}))},e.prototype.set=function(t,r){var a=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.fc)().ULS.traceTag(596449097,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.set: isKeyboardEvent = '".concat(r.isKeyboardEvent,"'; cutCopyPasteFlags = '").concat(r.commandType,"'")),Object(o.fc)().ULS.shipAssertTag(595932513,n.LogCategory.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),Object(o.Lb)()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&z())return Object(o.fc)().ULS.traceTag(596455681,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!z()&&!B())return Object(o.fc)().ULS.traceTag(596455682,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var i=this.lastDeferredCutCopyPromise,s="There exists a pending deferred promise with id '".concat(i.id,"', representing an active ").concat(o.p,"/").concat(o.j," event. Scheduling a rejection to execute after the current operation.");Object(o.fc)().ULS.traceTag(596455683,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,s),window.setTimeout((function(){i.reject(new o.e(r.isKeyboardEvent?o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:o.f.RejectingBlockedSyncCutCopyPromise,s))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var c=Object(o.V)();this.lastDeferredCutCopyPromise=c;var l=c.id;try{var d=Object(o.tb)(t),u=e.getClipboardCutCopyEventType(r.commandType),f=Object(o.P)(document,u,(function(e){r.isTimestampStoredInSystemClipboard=!0,a.cutCopyHandler(e,c,d,r.isKeyboardEvent,r.commandType,f)}));this.removeLastCutCopyEventListenerCallback=f;var p=o.jb;Object(o.Lb)()&&(p=Object(o.lb)(d,o.ec)),this.selectedRangeToRestore=ye(),this.activeElementIdToRestore=Se(!1,!!p,p);var g=!1;if(Object(o.Lb)()&&r.isKeyboardEvent||(g=r.commandType===o.r.Cut?oe().execCommandCut():oe().execCommandCopy()),r.isKeyboardEvent);else if(!g)return this.clearCutCopyCallbackConfiguration(c,!0,!0),!Object(o.Lb)()||z()||B()||(Object(o.fc)().ULS.traceTag(596455684,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '".concat(l,"'")),c.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(c,!0,!1),Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(l,"'"),e))}return c.promise.catch((function(e){return e&&Object(o.Hb)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(l,"'"),e))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.ec,o.Cb]},e.prototype.cutCopyHandler=function(e,t,r,a,i,s){var c=this;try{if(Object(o.fc)().ULS.traceTag(596449098,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; bubbles = '").concat(e.bubbles,"'; eventPhase = '").concat(e.eventPhase,"'")),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(o.fc)().ULS.shipAssertTag(596455686,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),!t)return;if(Object(o.fc)().ULS.traceTag(596455687,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; deferred promise id = '").concat(t.id,"'")),Object(o.fc)().ULS.shipAssertTag(596455688,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),t.fulfilled())return;var l=function(){t.resolve(),c.clearCutCopyCallbackConfiguration(t,!1,!1)},d=Object(o.lb)(r,o.ec);if(d&&Object(o.Lb)())window.setTimeout(l,0);else{d&&ae(o.ec,d,e,a);var u=Object(o.pb)(r);ae(oe().defaultClipboardDataFormat,u,e,a),e.preventDefault(),l()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(o.fc)().ULS.traceTag(596455689,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '".concat(t?t.id:o.jb,"' (fulfilled = '").concat(t?t.fulfilled():o.jb,"') failed with this exception: ").concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA")),t&&t.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,a,i){var s=this,c=!0;try{if(Object(o.fc)().ULS.traceTag(596449099,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; eventPhase='").concat(e.eventPhase,"'")),a(),this.removeLastPasteEventListenerCallback===a&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(o.fc)().ULS.shipAssertTag(596455690,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(r,"'")),!t)return;if(Object(o.fc)().ULS.traceTag(596455691,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; deferred promise id = '").concat(t.id,"'")),Object(o.fc)().ULS.shipAssertTag(596455692,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(r,"'")),t.fulfilled())return;Object(o.fc)().ULS.traceTag(541405714,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: Checking if navigator.clipboard exists");Object(o.fc)().ULS.traceTag(541405715,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: shouldLogAsyncApiImpact is false");var l=Object(o.R)(),d=this.getSupportedDataFormats(),u=this.readDataFormats(d,e,r,l,!!i.clipboardAsyncApiDataFormatsToRead);Promise.all(u).then((function(){e.stopPropagation(),c=!1,Object(o.Lb)()?window.setTimeout((function(){var e,r=document.getElementById("ccpContentEditable");if(r&&r.firstChild&&"IMG"===r.firstChild.nodeName){var a=r.firstChild;a&&a.src&&a.src.indexOf("base64")>-1?l.setItem(o.Cb,a.src):Object(o.fc)().ULS.traceTag(595907107,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else l.setItem(o.ec,(e=Ee(),Object(o.fc)().ULS.shipAssertTag(596444113,n.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?be.sanitize(e.innerHTML):o.jb)),o.Bb.isContainsTimestampWrapper(r)&&l.setItem(o.hb,o.Bb.createPlainTextFromHtml(r));we(),t.resolve(l),s.clearPasteCallbackConfiguration(t,!1,!1)}),0):(e.preventDefault(),we(),t.resolve(l),s.clearPasteCallbackConfiguration(t,!1,!1))}))}catch(r){we();try{c&&e.stopPropagation(),e.preventDefault()}catch(e){Object(o.fc)().ULS.traceTag(595985030,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: ".concat(n.utils.getStringifiedError(e)))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(o.fc)().ULS.traceTag(596455693,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '".concat(t?t.id:o.jb,"' (fulfilled = '").concat(t?t.fulfilled():o.jb,"') failed with an exception: ").concat(r&&r.message?r.message:"NA",". Call stack: ").concat(r.stack?r.stack:"NA")),t&&t.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(r&&r.message?r.message:"NA"),r))}},e.prototype.isFileFormat=function(e){return e===o.Cb},e.prototype.isPlainTextEmpty=function(e){var t=e.getItem("text/plain");return!t||0===t.length},e.prototype.readDataFormats=function(e,t,r,a,i){var s=this;if(!this.skipFilesIfPlainTextExists)return this.readDataFormatsInternal(e,t,r,a,i);var c=e.filter((function(e){return s.isFileFormat(e)}));if(0===c.length)return this.readDataFormatsInternal(e,t,r,a,i);var l=e.filter((function(e){return!s.isFileFormat(e)})),d=this.readDataFormatsInternal(l,t,r,a,i);return[Promise.all(d).then((function(){if(!s.isPlainTextEmpty(a))return Object(o.fc)().ULS.traceTag(595653317,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();var e=s.readDataFormatsInternal(c,t,r,a,i);return Promise.all(e)}))]},e.prototype.logClipboardReadTimeAndStatus=function(e){var t=this;Object(o.fc)().ULS.traceTag(545399641,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.logClipboardReadTimeAndStatus: Logging time taken to read data from clipboard and success or failure status"),e.clipboardFormatReadTimes=o.hb+":"+this.clipboardFormatReadTimes[o.hb]+","+o.ec+":"+this.clipboardFormatReadTimes[o.ec],e.clipboardFormatReadStatus=o.hb+":"+this.clipboardFormatReadStatus[o.hb]+","+o.ec+":"+this.clipboardFormatReadStatus[o.ec],e.clipboardAsyncApiDataFormatsToRead.forEach((function(r){e.clipboardFormatReadTimes+=","+r+":"+t.clipboardFormatReadTimes[r],e.clipboardFormatReadStatus+=","+r+":"+t.clipboardFormatReadStatus[r]})),e.asyncApiReadTimedOut=this.asyncApiReadTimedOut},e.prototype.initializeClipboardFormatReadArrays=function(e){var t=this;this.clipboardFormatReadStatus[o.hb]="_",this.clipboardFormatReadTimes[o.ec]="_",e.clipboardAsyncApiDataFormatsToRead.forEach((function(e){t.clipboardFormatReadStatus[e]="_",t.clipboardFormatReadTimes[e]="_"})),this.asyncApiReadTimedOut=!1},e.prototype.willClipboardReadPermissionPromptShow=function(){try{if(navigator.permissions){return navigator.permissions.query({name:"clipboard-read",allowWithoutGesture:!0}).then((function(e){return e&&"prompt"===e.state?Promise.resolve(!0):Promise.resolve(!1)}),(function(){return Promise.resolve(!1)}))}return Promise.resolve(!1)}catch(e){return Object(o.fc)().ULS.traceTag(540037264,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.willClipboardReadPermissionPromptShow: In catch block: "+e),Promise.resolve(!1)}},e.prototype.getAsyncTextReadPromiseWrapper=function(e,t,r,a,i){return new Promise((function(s){var c=!1;i().then((function(e){e||window.setTimeout((function(){c||(Object(o.fc)().ULS.traceTag(540160580,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromiseWrapper: navigator.clipboard.read() has timed out"),a(),s())}),1750)})),r(e,t).then((function(){c=!0,s()}))}))},e.prototype.getAsyncTextReadPromise=function(e,t){try{Object(o.fc)().ULS.traceTag(541646986,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Before calling navigator.clipboard.read()");var r=window.performance.now(),a=navigator.clipboard.read();return Object(o.fc)().ULS.traceTag(541646987,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Created navigator.clipboard.read() promise"),a.then((function(e){return Object(o.fc)().ULS.traceTag(541646988,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Inside first navigatorReadPromise then() block"),e[0].getType(o.hb)})).then((function(e){return e.text()})).then((function(){return Object(o.fc)().ULS.traceTag(545399642,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Plain text successfully read using Async API"),e[o.hb+"Async"]=(window.performance.now()-r).toFixed(3).toString(),t[o.hb+"Async"]="success",Promise.resolve()}),(function(a){return Object(o.fc)().ULS.traceTag(543470850,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Promise rejected:"+a),e[o.hb+"Async"]=(window.performance.now()-r).toFixed(3).toString(),t[o.hb+"Async"]="failure",Promise.resolve()})).catch((function(a){return Object(o.fc)().ULS.traceTag(545118098,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Inside inner catch block:"+a),e[o.hb+"Async"]=(window.performance.now()-r).toFixed(3).toString(),t[o.hb+"Async"]="failure",Promise.resolve()}))}catch(e){return Object(o.fc)().ULS.traceTag(545118099,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Inside outer catch block:"+e),Promise.resolve()}},e.prototype.readDataFormatsInternal=function(e,t,r,a,i){var s=[],c={};return e.forEach((function(e){!i||e!==o.hb&&e!==o.ec||(c[e]=window.performance.now()),s.push(function(e,t,r){return he().getData(e,t,r)}(e,t,r).then((function(t){if(i&&(e===o.hb||e===o.ec)){var r=(window.performance.now()-c[e]).toFixed(3).toString();Object(o.fc)().ULS.traceTag(538248469,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read successful, Format="+e+",TimeInMs="+r)}Object(o.fc)().ULS.traceTag(541646989,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+e+" from clipboard"),a.setItem(e,t)})).catch((function(t){if(i&&(e===o.hb||e===o.ec)){var r=(window.performance.now()-c[e]).toFixed(3).toString();Object(o.fc)().ULS.traceTag(538248470,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read failed, Format="+e+",TimeInMs="+r)}Object(o.fc)().ULS.traceTag(595653318,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [".concat(e,"]. Error [").concat(n.utils.getStringifiedError(t),"]"))})))})),s},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(o.fc)().ULS.traceTag(595993058,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ".concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(o.hb)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.bc)([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return o.k;if(e===o.r.Copy)return o.k;if(e===o.r.Cut)return o.q;throw new o.t(o.jb,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(!function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(o.fc)().ULS.shipAssertTag(595957697,n.LogCategory.msoulscat_ES_EWAJS,!ve(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(o.fc)().ULS.traceTag(596449290,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.set: the ".concat(o.p,"/").concat(o.j," event listener was not called. Calling removeLastCutCopyEventListenerCallback()")),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Ce(!1),Object(o.fc)().ULS.shipAssertTag(595957698,n.LogCategory.msoulscat_ES_EWAJS,!ve(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(o.fc)().ULS.traceTag(596449291,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.get: the ".concat(o.E," event listener was not called. Calling removeLastPasteEventListenerCallback()")),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e.prototype.clearSystemClipboard=function(){var e=Object(o.sb)(),t={isKeyboardEvent:!1,commandType:o.r.Copy};this.set(e,t).then((function(){Object(o.fc)().ULS.traceTag(595935906,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(function(){Object(o.fc)().ULS.traceTag(595935907,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))},e}(),Pe=function(e){function t(t){return e.call(this,o.i.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},t)||this}return Object(c.__extends)(t,e),t}(o.h),Oe=function(){function e(){this.clipboardStorageType=o.g.InMemory,this.disposableImplementationExtension=Object(o.X)("InMemoryClipboardStorage")}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())},e.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(Object(o.sb)())},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.ec,"data/shadow-workbook"]},e}(),Ae=function(e){function t(t){return e.call(this,o.i.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),je=function(){function e(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Object(o.X)("".concat(e))}return e.prototype.initialize=function(e,t){var r=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((function(e){return r.systemClipboardStrategy=e,t.then((function(e){return r.fullAccessClipboardStrategy=e,r.initialized=!0,Promise.resolve(r)}))}))},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var a={systemClipboardOperationResult:Object(o.T)(o.Wb,"setresult",!1),fullAccessClipboardOperationResult:Object(o.T)(o.Wb,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Hb)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)})).then((function(a){return r.fullAccessClipboardStrategy?r.fullAccessClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return Object(o.fc)().ULS.traceTag(595933078,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '".concat(r.fullAccessClipboardStrategy&&r.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(t.id?t.id:o.jb,"', Error: ").concat(n.utils.getStringifiedError(e))),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(a)})):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a))})).then((function(e){if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){var t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new o.e(o.f.SetClipboardItems,o.jb))}return Promise.resolve()}))}catch(e){return Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Object(o.T)(o.Wb,"getresult",!1,void 0,Object(o.qb)()),fullAccessClipboardOperationResult:Object(o.T)(o.Wb,"getresult",!1,void 0,Object(o.qb)())};return this.systemClipboardStrategy.get(e).then((function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)})).catch((function(e){return r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Gb)(e,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.resolve(r)})).then((function(r){return t.fullAccessClipboardStrategy?t.fullAccessClipboardStrategy.get(e).then((function(e){return r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return Object(o.fc)().ULS.traceTag(595933079,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '".concat(t.fullAccessClipboardStrategy&&t.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(e.id?e.id:o.jb,"', Error: ").concat(n.utils.getStringifiedError(a))),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)})):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))})).then((function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.fullAccessClipboardOperationResult.failed){var a=r.systemClipboardOperationResult.clipboardOperationResultError;return a||(a=r.fullAccessClipboardOperationResult.clipboardOperationResultError),a?Promise.reject(a):Promise.reject(new o.e(o.f.GetClipboardItems,o.jb))}return 0===Object(o.ob)(r.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResult.clipboardOperationResultError):t.validateAndReturnFullAccessData(r)}return r.fullAccessClipboardOperationResult.failed?Promise.resolve(Object(o.R)(r.systemClipboardOperationResult.clipboardItemsData)):function(){if(Object(o.Ib)()&&!Object(o.Kb)())return!0;return!1}()?t.pasteSourceReconciliationBasedOnlyOnTextPlain(r):t.pasteSourceReconciliation(r,e)}))}catch(e){return Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(Object(o.fc)().ULS.shipAssertTag(595882509,n.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))):Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new o.e(o.f.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.bc)([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.fullAccessClipboardStrategy&&e.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);var a=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(a=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),Object(o.fc)().ULS.traceTag(595719624,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=".concat(r," ccpTimestampInFullAccessClipboard=").concat(a)),r?r>(a||0)?(xe(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):t.isTimestampStoredInSystemClipboard?(xe(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)},e.prototype.validateAndReturnFullAccessData=function(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){if(0===Object(o.ob)(e.systemClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData));if(0===Object(o.ob)(e.fullAccessClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData));var t=e.systemClipboardOperationResult.clipboardItemsData.items[o.hb],r=o.Bb.ensureOneLFPerNewLine(o.Bb.trimToLength(t)),a=e.fullAccessClipboardOperationResult.clipboardItemsData.items[o.hb];return r===o.Bb.ensureOneLFPerNewLine(o.Bb.trimToLength(a))?Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):r===Ue().getCopyToClipboardLatencyMessage()?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[o.Sb]=o.Ub,Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function xe(e,t){e.items[o.Sb]=o.Ub,t&&(e.items[o.Tb]=o.Vb)}var De=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},o.i.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(je),Me=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},o.i.InMemory,t)||this}return Object(c.__extends)(t,e),t}(je),We=function(e){function t(t){return e.call(this,o.g.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(function(e){function t(t,r){var a=e.call(this)||this;if(a.messageDestination=r,!r)throw new o.B(o.jb,"messageDestination");return a.clipboardStorageType=t,a.disposableImplementationExtension=Object(o.X)(r),a}return Object(c.__extends)(t,e),t.prototype.initialize=function(){var e=this;return this.innerInitialize().then((function(){return e}))},t.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.fc)().ULS.traceTag(595947538,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.get: isKeyboardEvent = ".concat(e.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(e.silentClipboardAccessFailures||!1));var t=Object(o.S)(Object(o.bb)(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then((function(e){return e.clipboardItemsData?Promise.resolve(Object(o.R)(e.clipboardItemsData)):Promise.resolve(Object(o.sb)())}))},t.prototype.set=function(e,t){var r;return this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.fc)().ULS.traceTag(595947541,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.set: isKeyboardEvent = ".concat(t.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(t.silentClipboardAccessFailures||!1)),r=Object(o.nb)(e)>0?Object(o.S)(Object(o.bb)(),"set",this.messageDestination,t.userHash,e.getData()):Object(o.S)(Object(o.bb)(),"set",this.messageDestination),this.postMessage(r,"set").then((function(){}))},t.prototype.clearClipboardNecessary=function(e,t){return Object(o.dc)(e,t)},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.ec,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},t}(U));function Re(e,t,r,a,s){var c=function(e,t,r){return new w(e,t,r)}(r,a,s);return function(e,t,r){var a=o.s.NoError;return n.utils.chainFallbackPromises(e,(function(e){return function(e,t,r){Object(o.fc)().ULS.traceTag(595716231,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '".concat(e.clipboardStrategyType,"'"));var a=function(){return function(){switch(e.clipboardStrategyType){case o.i.SystemClipboard:case o.i.SystemClipboardAndInMemory:return e;case o.i.SystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new o.L("createClipboardEnvironmentComponentsByType:getSystemClipboardParameters couldn't be used for ".concat(e.clipboardStrategyType))}}().skipFilesIfPlainTextExists},s=function(){switch(e.clipboardStrategyType){case o.i.LocalStorage:return e;case o.i.SystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new o.L("createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for ".concat(e.clipboardStrategyType))}},c=function(e){return r.createClipboardDataProcessor(e)},l=function(){return r.createClipboardMetaDataProcessor()},d=function(e){return r.createDualClipboardDataProcessor(e)},f=function(){return new N},p=function(e){return function(e){return new F(e)}(e)},g=function(){var e=s();return e.useSharedClipboardIframe?f():p(Object(o.wb)(e.sharedClipboardSchemaVersion))},m=function(){return(new J).initialize(Promise.resolve((e=a(),new Ie(e))));var e},h=function(e){return function(e){return new Pe(e)}(e).initialize(Promise.resolve(new Oe))},b=function(e,t){var r,a,n=s();return n.useSharedClipboardIframe?(function(e){var t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId);var r=e.sharedClipboardOverrideOrigin?1:0;o.cc.initializeSharedClipboardSettings({sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r}),i(t)}(n),function(e){return new Ae(e)}(t).initialize((r=e?o.z.localStorageMetadata:o.z.localStorageData,new We(r)).initialize())):function(e){return new o.x(e)}(t).initialize(Promise.resolve((a=e?Object(o.vb)(n.sharedClipboardSchemaVersion):Object(o.ub)(n.sharedClipboardSchemaVersion),new o.w(a))))},y=function(e,r,a){return Promise.all([e,r]).then((function(e){var r=e[0];return function(e,r){return(r?r.initialize(e):Promise.resolve(void 0)).then((function(){return u(e,t,r)}))}(e[1],a).then((function(e){return{dataClipboardStrategy:r,metadataManager:e}}))}))};try{switch(e.clipboardStrategyType){case o.i.SystemClipboard:return y(m(),h(l()));case o.i.InMemory:return y(h(c(!1)),h(l()));case o.i.LocalStorage:return y(b(!1,c(!0)),b(!0,l()),g());case o.i.SystemClipboardAndLocalStorage:return y((S=d(!0),new De(S)).initialize(m(),b(!1)),b(!0,l()),g());case o.i.SystemClipboardAndInMemory:return y(function(){return(e=d(!1),new Me(e)).initialize(m(),h());var e}(),h(l()))}return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"Clipboard strategy type '".concat(e.clipboardStrategyType,"' is not supported")))}catch(t){return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"failed to create clipboardStrategyType: '".concat(e.clipboardStrategyType,"' with error: ").concat(n.utils.getStringifiedError(t))))}var S}(e,t,r).then((function(t){return Object(o.fc)().ULS.traceTag(595716294,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '".concat(e.clipboardStrategyType,"' was created.")),t.infraInitializationError=a,t})).catch((function(t){if(t&&t.innerError&&"string"==typeof t.innerError)try{JSON.parse(t.innerError).reason===o.f.LocalStorageInitilizationInaccessible&&(a=o.s.LocalStorageInaccessible)}catch(e){}var r="clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '".concat(e.clipboardStrategyType,"'. Error: ").concat(n.utils.getStringifiedError(t));return Object(o.fc)().ULS.traceTag(595716230,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,r),Promise.reject(new o.e(o.f.SelectClipboardStrategy,r,t))}))}))}(e,t,c).then((function(e){return{dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:c,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}}))}function Ue(){return Je}var Fe;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(Fe||(Fe={}));var Ne={initializationStatus:Fe.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:o.cc.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:o.s.NoError},Je={init:function(e,t,r,a,i,s,c,l,d,u,f,p,g,m,h,b,y,S){if(Ne.lastClipboardPlatformEnvironmentInitializationInfo)return Promise.resolve(Ne.lastClipboardPlatformEnvironmentInitializationInfo);e&&Object(n.initEwaUtils)(e);if(Object(o.Eb)(t),!r||!Array.isArray(r))return Promise.reject(new o.B(o.jb,"chromeExtensionIds"));Object(o.fc)().ULS.traceTag(596455702,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardPlatformEnvironment.init: chromeExtensionIds = '".concat(JSON.stringify(r),"'")),Ne.chromeExtensionIds=He(r),f&&(Ne.copyToClipboardLatencyMessage=f);"number"!=typeof u||isNaN(u)||(Ne.clipboardPromiseTimeoutInMinutes=u);return Ne.initializationStatus=Fe.StateReady,Re(m,g,h,b,y).then((function(e){return Ne.clipboardDataManager=e.clipboardDataManager,Ne.metadataManager=e.metadataManager,Ne.clipboardStrategy=e.dataClipboardStrategy,Ne.initializationError=e.infraInitializationError,Ne.initializationStatus=Fe.InitializationSucceed,Ne.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:m,dataClipboardCapabilities:Ne.clipboardStrategy&&Ne.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:Ne.clipboardStrategy&&Ne.clipboardStrategy.clipboardStrategyType,infraInitializationError:Ne.initializationError},Ne.lastClipboardPlatformEnvironmentInitializationInfo}))},getClipboardStrategy:function(){if(ke(),!Ne.clipboardStrategy)throw new o.u("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return Ne.clipboardStrategy},getChromeExtensionIds:function(){return ze(),Ne.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return ze(),Ne.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return ze(),Ne.copyToClipboardLatencyMessage},getMetadataManager:function(){return ke(),Ne.metadataManager},getClipboardDataManager:function(){return ke(),Ne.clipboardDataManager},getInitializationError:function(){return ke(),Ne.initializationError}};function ke(){if(Ne.initializationStatus!==Fe.InitializationSucceed)throw new o.u("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function ze(){if(Ne.initializationStatus<Fe.StateReady)throw new o.u("ClipboardPlatformEnvironment state is not ready. Call init(...).")}function He(e){var t=[];if(!e)return t;for(var r=0,a=e;r<a.length;r++){var o=a[r];o&&"string"==typeof o&&o.trim().length>0&&t.push(o)}return t}r.d(t,"createClipboardItems",(function(){return o.R})),r.d(t,"getClipboardPlatformEnvironment",(function(){return Ue}))},97:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,a){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(a,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var a={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var o=Object.getPrototypeOf(t);o&&"object"==typeof o&&Object.keys(o).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var n={};return Object.keys(a).forEach((function(t){n[t]=e(a[t],r+1)})),n}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var a=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),a=function(t){r=r.catch((function(r){return e(t,r)}))},o=1;o<=t;o+=1)a(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),a=function(a){var o=e[a];r=r.catch((function(){return t(o)}))},o=1;o<e.length;o+=1)a(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,a=e.length,o=0;o<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==a-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var a=-1,o=null;if(void 0!==document.caretPositionFromPoint)null!==(n=document.caretPositionFromPoint(e,t))&&(a=n.offset,o=null!=n.offsetNode&&null!=n.offsetNode.parentElement&&"SPAN"===n.offsetNode.parentElement.nodeName?n.offsetNode.parentElement:n.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(n=document.caretRangeFromPoint(e,t))&&(a=n.startOffset,o=null!=n.startContainer&&null!=n.startContainer.parentElement&&"SPAN"===n.startContainer.parentElement.nodeName?n.startContainer.parentElement:n.startContainer)}else try{var n;o=document.elementFromPoint(e,t),(n=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(o),i.setEndPoint("EndToStart",n),a=i.text.length}catch(e){return a}if(r)for(var s=!1;null!=o;)null===o.previousSibling&&null!==o.parentNode&&null!==o.parentNode.parentNode&&o.parentNode.parentNode.childNodes.length>1&&!s?(o=o.parentNode,s=!0):null!=(o=o.previousSibling)&&null!=o.textContent&&(a+=o.textContent.length,s&&(a+=1));else for(;null!=o;)null!=(o=o.previousSibling)&&null!=o.textContent&&(a+=o.textContent.length);return a},t.getBoundingRectForText=function(e,t,r,a){function o(e,t,r){if(!e||!e.textContent)return t;if(a&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var n=e.childNodes,i=0;i<n.length&&t>=0;i+=1)t=o(n[i],t,r),a&&"DIV"===n[i].nodeName&&(t-=1);return t}void 0===a&&(a=!1);var n=document.createRange();return o(e,t,(function(e,t){return n.setStart(e,t)})),o(e,r,(function(e,t){return n.setEnd(e,t)})),n.getBoundingClientRect()}}});
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/clipboardPlatform.min.js.map/c8b75c88a1b7052898acd30b49786dab/clipboardPlatform.min.js.map